(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-5a8e011c"],{"0554":function(t,e,i){},"2d8c":function(t,e,i){"use strict";i("0554")},6586:function(t,e,i){"use strict";i("9306")},9306:function(t,e,i){},f3d7:function(t,e,i){"use strict";i.r(e);var o=(i("d3b7"),i("159b"),function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("Modal",{attrs:{title:t.title,closable:!1,"mask-closable":!1,loading:"","footer-hide":""},model:{value:t.value,callback:function(e){t.value=e},expression:"value"}},[i("Form",{attrs:{"label-width":180}},[i("FormItem",{attrs:{label:t.$t("rebate.teamcCommissionLevel")}},[t._v(" "+t._s(t.level)+" ")]),i("FormItem",{attrs:{label:t.$t("rebate.teamcCommissionRatio"),prop:"contactMobile"}},[i("InputNumber",{staticClass:"rl_input",attrs:{max:100,precision:3,"active-change":!1},model:{value:t.ratio,callback:function(e){t.ratio=e},expression:"ratio"}}),t._v(" % ")],1),i("FormItem",[i("Button",{attrs:{type:"primary",loading:t.loading},on:{click:function(e){return t.save()}}},[t._v(t._s(t._f("lang")("confirm")))]),i("Button",{staticStyle:{"margin-left":"8px"},on:{click:function(e){return t.$emit("input",!1)}}},[t._v(t._s(t._f("lang")("cancel")))])],1)],1),t.showSpin?i("Spin",{attrs:{size:"large",fix:""}}):t._e()],1)}),s=(i("a9e3"),{props:{value:{default:!1,type:Boolean},detail:{default:null,type:Object},maxLevel:{default:0,type:Number}},data:function(){return{ratio:null,loading:!1,level:1,preRatio:0,showSpin:!1}},methods:{init:function(){if(this.detail){var t=this.detail,e=t.proxyLevel,i=t.ratio;this.level=e,this.ratio=+i/1e3}else this.level=this.maxLevel+1},save:function(){var t=this,e=this.ratio;if(e)if(e<=+this.preRatio)this.$Message.error(this.$t("rebate.pleaseEnterTheCommissionRatio",{preRatio:this.preRatio}));else if(e>100)this.$Message.error(this.$t("rebate.theCommissionRatioCannotBeGreaterThan100"));else if(e<.001)this.$Message.error(this.$t("rebate.theCommissionRatioCannotBeLessThan001"));else{this.loading=!0;var i=Boolean(this.detail),o=i?"/user/comminssion/tob/updateCommissionSetting":"/user/comminssion/tob/addCommissionSetting",s={proxyRatio:1e3*this.ratio,proxyLevel:this.level,id:this.detail?this.detail.id:""};i&&(s.id=this.detail.id),this.$post(o,s).then((function(){t.$emit("save"),t.$Message.success(i?t.$t("rebate.editSucceeded"):t.$t("rebate.addSucceeded"))})).catch((function(e){t.$Message.error(e.message)})).finally((function(){t.loading=!1}))}else this.$Message.error(this.$t("rebate.pleaseEnterTheCommissionRatio"))}},computed:{title:function(){return this.detail?this.$t("rebate.editCommissionLevel"):this.$t("rebate.addCommissionLevel")}},watch:{value:function(){this.value?this.init():this.ratio=null}}}),n=s,a=(i("2d8c"),i("2877")),r={data:function(){return{showDrawer:!1,detail:null,columns:[{title:this.$t("rebate.serialNumber"),key:"index"},{title:this.$t("rebate.agencyLevel"),key:"proxyLevel"},{title:this.$t("rebate.teamCommissionRatio"),key:"proxyRatio"},{title:this.$t("rebate.operate"),key:"operation",slot:"operation"}],dataList:[],showSpin:!1,openStatus:!0,popTitle:"",openUrl:{}}},methods:{init:function(){var t=this;this.$get("/user/comminssion/tob/getCommissionSwitch").then((function(e){t.openUrl=e,t.openStatus=1===e.isEnable})).catch((function(e){t.$Message.error(e.meassage)}))},query:function(){var t=this;this.showSpin=!0,this.$get("/user/comminssion/tob/getCommissionSetting").then((function(e){if(t.dataList=e||[],e&&e.length){var i=[];e.forEach((function(t,e){var o={};o.ratio=t.proxyRatio,o.proxyRatio=t.proxyRatio/1e3+"%",o.index=e+1,o.proxyLevel=t.proxyLevel,o.id=t.id,o.lineId=t.id,i.push(o)})),t.dataList=i}})).finally((function(){t.showSpin=!1}))},handleBeforeChange:function(){var t=this,e=this.openStatus?this.$t("rebate.closetAgentCommissionActivity"):this.$t("rebate.startAgentCommissionActivity");return new Promise((function(){t.$Modal.confirm({title:t.$t("rebate.confirmPrompt"),content:e,onOk:function(){t.changeStatus()}})}))},changeStatus:function(){var t=this;this.showSpin=!0;var e=this.openStatus?0:1;this.$post("/user/comminssion/tob/updateCommissionSwitch",{isEnable:e,id:this.openUrl.id}).then((function(){t.openStatus=!t.openStatus})).catch((function(e){t.$Message.error(e.message)})).finally((function(){t.showSpin=!1}))},add:function(){this.detail=null,this.showDrawer=!0},edit:function(t){this.detail=t,this.showDrawer=!0},del:function(t){var e=this;this.showSpin=!0,this.$post("/user/comminssion/tob/deleteCommissionSetting",{proxyLevel:t.proxyLevel}).then((function(){e.$Message.success(e.$t("rebate.deleteSucceeded")),e.query()})).catch((function(t){e.$Message.error(t.message)})).finally((function(){e.showSpin=!1}))},save:function(){this.showDrawer=!1,this.query()}},components:{drawer:Object(a.a)(n,o,[],!1,null,null,null).exports},mounted:function(){this.init(),this.query()}},l=r,c=(i("6586"),Object(a.a)(l,(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",[i("Form",{attrs:{inline:""}},[this.buttonMap["user/comminssion/tob"]&&this.buttonMap["user/comminssion/tob"].updateCommissionSwitch?i("FormItem",{attrs:{label:t.$t("rebate.whetherTheActivityIsOn"),"label-width":220,prop:"isOpen"}},[i("i-switch",{attrs:{"before-change":t.handleBeforeChange},model:{value:t.openStatus,callback:function(e){t.openStatus=e},expression:"openStatus"}},[i("span",{attrs:{slot:"true"},slot:"true"},[t._v("开")]),i("span",{attrs:{slot:"false"},slot:"false"},[t._v("关")])])],1):t._e(),i("FormItem",{staticClass:"fr"},[t.pageauthoritys.add?i("Button",{attrs:{type:"primary",icon:"md-add"},on:{click:function(e){return t.add()}}},[t._v(t._s(t._f("lang")("rebate.addLevel")))]):t._e()],1)],1),i("m-table",{attrs:{border:"",columns:t.columns,data:t.dataList},scopedSlots:t._u([{key:"operation",fn:function(e){var o=e.row;return[i("div",{staticClass:"operation-btn-group"},[i("Tooltip",{attrs:{content:t.$t("rebate.edit"),placement:"top"}},[t.pageauthoritys.update?i("Button",{attrs:{icon:"md-create"},on:{click:function(e){return t.edit(o)}}}):t._e()],1),t.pageauthoritys.delete?i("Tooltip",{attrs:{content:t.$t("rebate.delete"),placement:"top"}},[i("Poptip",{attrs:{confirm:"",title:t.$t("rebate.areYouSureYouWantToDelete")},on:{"on-ok":function(e){return t.del(o)}}},[i("Button",{attrs:{icon:"md-trash"}})],1)],1):t._e()],1)]}}])}),i("drawer",{attrs:{detail:t.detail,maxLevel:t.dataList.length},on:{save:function(e){return t.save()}},model:{value:t.showDrawer,callback:function(e){t.showDrawer=e},expression:"showDrawer"}}),t.showSpin?i("Spin",{attrs:{size:"large",fix:""}}):t._e()],1)}),[],!1,null,null,null));e.default=c.exports}}]);