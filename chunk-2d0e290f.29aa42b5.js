(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-2d0e290f"],{"7ef1":function(t,e,n){"use strict";n.r(e);var s=(n("d3b7"),n("d81d"),{name:"Message",data:function(){return{loading:!1,showAddMessage:!1,modal1:!1,content:"",statusList:[{label:this.$t("all"),value:0},{label:this.tFn("haveRead"),value:1},{label:this.tFn("unread"),value:2}],columns:[{type:"selection",width:60,align:"center"},{title:this.tFn("title"),slot:"title"},{title:this.$t("time"),key:"createTime"},{title:this.$t("operation"),key:"operation",slot:"action"}],status:+this.$route.query.status||0,msgList:[],page:1,size:20,totalElements:0,editItem:{},editType:"",tabList:[]}},components:{},methods:{tFn:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.$t("systemManager.".concat(t),e)},selectHandle:function(t){this.tabList=t},pageSizeChange:function(t){this.size=t,this.query()},handleEdit:function(t){this.editType="edit",this.showAddMessage=!0,this.editItem=JSON.parse(JSON.stringify(t))},showConfirm:function(t){var e=this;return new Promise((function(){e.$Modal.confirm({title:e.$t("delete"),content:e.$t("deleteTip"),onOk:function(){e.loading=!0,e.$post("/pubmes/message/tob/batchDel",{ids:[t.id]},{formatway:"repeat"}).then((function(){e.$Message.success(e.$t("opSuccess")),e.loading=!1,e.query()})).catch((function(t){e.$Message.error(t.message),e.loading=!1}))}})}))},muilteDel:function(){var t=this;if(this.tabList.length){var e=[];return this.tabList.map((function(t){e.push(t.id)})),new Promise((function(){t.$Modal.confirm({title:t.$t("delete"),content:t.$t("deleteTip"),onOk:function(){t.loading=!0,t.$post("/pubmes/message/tob/batchDel",{ids:e},{formatway:"repeat"}).then((function(){t.$Message.success(t.$t("opSuccess")),t.loading=!1,t.query()})).catch((function(e){t.$Message.error(e.message),t.loading=!1}))}})}))}this.$Message.info(this.tFn("pleaseSelect"))},markRead:function(t){var e=this;this.modal1=!0,this.content=t.content,this.$post("/pubmes/message/tob/markRead",{id:t.id}).then((function(){})).catch((function(t){e.$Message.error(t.message)})).finally((function(){}))},onOk:function(){this.modal1=!1,this.query()},query:function(){var t=this;this.loading||(this.loading=!0,this.$get("/pubmes/message/tob/queryPage",{pageIdx:this.page,pageSize:this.size,status:this.status}).then((function(e){t.msgList=e.content,t.totalElements=+e.totalElements})).catch((function(e){t.$Message.error(e.message)})).finally((function(){t.loading=!1})))}},mounted:function(){this.query()}}),a=s,i=n("2877"),o=Object(i.a)(a,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[t.loading?n("Spin",{attrs:{fix:""}}):t._e(),t.pageauthoritys.delete?n("Button",{staticClass:"m-r-10",attrs:{type:"primary"},on:{click:t.muilteDel}},[t._v(t._s(t.tFn("batchDeletion")))]):t._e(),n("Button",[t._v(t._s(t._f("lang")("status")))]),n("Select",{staticClass:"width-120",on:{"on-change":t.query},model:{value:t.status,callback:function(e){t.status=e},expression:"status"}},t._l(t.statusList,(function(e){return n("Option",{key:e.value,attrs:{value:e.value}},[t._v(t._s(e.label))])})),1),n("Table",{ref:"selection",staticClass:"m-t-20",attrs:{columns:t.columns,border:"",data:t.msgList},on:{"on-selection-change":t.selectHandle},scopedSlots:t._u([{key:"title",fn:function(e){var s=e.row;return[s.readFlag?n("span",[t._v("["+t._s(t.tFn("haveRead"))+"] ")]):n("span",{staticStyle:{color:"red"}},[t._v("["+t._s(t.tFn("unread"))+"]")]),n("span",{staticStyle:{cursor:"pointer"},on:{click:function(e){return t.markRead(s)}}},[n("span",{staticStyle:{color:"#2d8cf0"}},[t._v("["+t._s(t.tFn("systemInformation"))+"]")]),t._v(" "+t._s(s.content)+" "+t._s(s.title))])]}},{key:"action",fn:function(e){var s=e.row;return[n("div",{staticClass:"td-cell"},[n("span",{on:{click:function(e){return t.showConfirm(s)}}},[t.pageauthoritys.delete?n("Button",{attrs:{size:"small",type:"warning"}},[t._v(t._s(t._f("lang")("delete")))]):t._e()],1)])]}}])}),n("Modal",{attrs:{title:t.tFn("messageContent")},on:{"on-ok":t.onOk,"on-cancel":t.onOk},model:{value:t.modal1,callback:function(e){t.modal1=e},expression:"modal1"}},[n("p",[t._v(t._s(t.content))])]),n("m-page",{ref:"pageRef",attrs:{total:t.totalElements,pageSize:t.size,pageSizeOpts:[20,30,50,100,500]},on:{"on-change":t.query,"on-page-size-change":t.pageSizeChange},model:{value:t.page,callback:function(e){t.page=e},expression:"page"}})],1)}),[],!1,null,null,null);e.default=o.exports}}]);