(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-341dbb8a"],{"0b92":function(t,e,a){"use strict";e.a={password:{reg:/^[A-Za-z0-9]{6,20}$/},username:{reg:/^(?!_)(?!.*?_$)(?!.*(_).*\1)[A-Za-z0-9_]{6,20}$/,isNumber:/^\d+$/g},No2:{pattern:/^(([1-9]{1}\d{0,9})|(0{1}))(\.\d{0,2})?$/,message:"请填写正确的金额"},email:{pattern:/^[A-Za-z0-9\u4e00-\u9fa5-_.]+@[a-zA-Z0-9_-]+(\.[a-zA-Z_-]+)+$/},hostName:{pattern:/^[a-z0-9]+([-.]{1}[a-z0-9]+)*.[a-z]{2,5}$/}}},"241b":function(t,e,a){},2771:function(t,e,a){"use strict";a("241b")},3618:function(t,e,a){"use strict";a("ab81")},7531:function(t,e,a){"use strict";a.r(e);var s=(a("d3b7"),a("d81d"),function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("Modal",{attrs:{title:t.title,width:"800"},model:{value:t.value2,callback:function(e){t.value2=e},expression:"value2"}},[[a("Form",{ref:"formValue",staticStyle:{"min-height":"400px"},attrs:{"label-width":100,model:t.formValue,rules:t.formValueRule}},[a("FormItem",{ref:"type",attrs:{prop:"type",label:t.$t("taxSet.type")}},[a("Select",{staticStyle:{width:"200px"},attrs:{disabled:t.disabled},on:{"on-change":t.handleChange},model:{value:t.formValue.type,callback:function(e){t.$set(t.formValue,"type",e)},expression:"formValue.type"}},t._l(t.typeList,(function(e){return a("Option",{key:e.value,attrs:{value:e.value}},[t._v(t._s(e.label))])})),1),t.disabled?t._e():a("div",{staticStyle:{"padding-top":"10px",color:"red"}},[t._v(t._s(t._f("lang")("taxSet.tips")))])],1),a("FormItem",{directives:[{name:"show",rawName:"v-show",value:2==t.formValue.type,expression:"formValue.type == 2"}],ref:"rankLevel",attrs:{prop:"rankLevel",label:t.$t("taxSet.level")}},[a("Select",{staticStyle:{width:"200px"},attrs:{disabled:t.disabled},model:{value:t.formValue.rankLevel,callback:function(e){t.$set(t.formValue,"rankLevel",e)},expression:"formValue.rankLevel"}},t._l(t.levelList,(function(e){return a("Option",{key:e.rankLevel,attrs:{value:e.rankLevel}},[t._v(t._s(e.rankLevel))])})),1)],1),a("FormItem",{directives:[{name:"show",rawName:"v-show",value:t.formValue.type<2,expression:"formValue.type < 2"}],ref:"account",attrs:{prop:"account",label:t.$t("taxSet.account")}},[a("Input",{staticStyle:{width:"200px"},attrs:{disabled:t.disabled,placeholder:t.$t("taxSet.toast3")},model:{value:t.formValue.account,callback:function(e){t.$set(t.formValue,"account","string"==typeof e?e.trim():e)},expression:"formValue.account"}}),t.disabled?t._e():a("Button",{staticStyle:{margin:"0 10px"},attrs:{type:"primary",showSpin:t.showSpinBtn},on:{click:t.queryUserName}},[t._v(" "+t._s(t._f("lang")("fm.inquire"))+" ")])],1),t.userSearched?[a("FormItem",{class:{"text-red":0!=+t.userSearched.isDemo},attrs:{label:t.$t("fundManager.accountType")}},[t._v(t._s(t.userType[t.userSearched.isDemo]))]),a("FormItem",{attrs:{label:t.$t("fundManager.hierarchicalPath")}},[t._v(t._s(t.userSearched.path))]),a("FormItem",{attrs:{label:t.$t("fundManager.userStatus")}},[t._v(t._s(t.statusList[t.userSearched.status]))]),a("FormItem",{attrs:{label:t.$t("fundManager.accountBalance")}},[t._v(t._s(t._f("to100fix")(t.userSearched.totalAmount)))]),a("FormItem",{attrs:{label:t.$t("remark")}},[t._v(t._s(t.userSearched.remark))])]:t._e(),2==t.formValue.type||t.userTable?[a("FormItem",{ref:"params",attrs:{label:t.$t("taxSet.params")}},[a("table",{staticClass:"cmtable tdcenter"},[a("tr",[a("th",[t._v(t._s(t._f("lang")("siteConfig.taxSetTable2")))]),a("th",[t._v(t._s(t._f("lang")("siteConfig.taxSetTable3")))]),a("th",[t._v(t._s(t._f("lang")("siteConfig.taxSetTable4")))]),t.taxSetList.length?a("th"):a("th",[a("Button",{staticStyle:{margin:"0 10px"},attrs:{type:"primary"},on:{click:t.handleAdd}},[a("Icon",{attrs:{type:"md-add"}})],1),a("Button",{attrs:{type:"primary"},on:{click:function(e){return t.taxSetList.pop()}}},[a("Icon",{attrs:{type:"md-trash"}})],1)],1)]),t._l(t.taxSetList,(function(e,s){return a("tr",{key:s},[a("td",[a("InputNumber",{staticStyle:{width:"100px"},attrs:{max:9999999999,min:1,precision:0,"active-change":!1},model:{value:e.minMoney,callback:function(a){t.$set(e,"minMoney",a)},expression:"i.minMoney"}}),t._v(" ~ "),a("InputNumber",{staticStyle:{width:"100px"},attrs:{max:9999999999,min:e.minMoney+1,precision:0,"active-change":!1},model:{value:e.maxMoney,callback:function(a){t.$set(e,"maxMoney",a)},expression:"i.maxMoney"}})],1),a("td",[a("InputNumber",{attrs:{max:100,min:0,precision:2,"active-change":!1,formatter:function(t){return t+"%"},parser:function(t){return t.replace("%","")}},model:{value:e.memberTaxRate,callback:function(a){t.$set(e,"memberTaxRate",a)},expression:"i.memberTaxRate"}})],1),a("td",[a("InputNumber",{attrs:{max:100,min:0,"active-change":!1,precision:2,formatter:function(t){return t+"%"},parser:function(t){return t.replace("%","")}},model:{value:e.platformTaxRate,callback:function(a){t.$set(e,"platformTaxRate",a)},expression:"i.platformTaxRate"}})],1),s===t.taxSetList.length-1?a("td",[a("Button",{staticStyle:{margin:"0 10px"},attrs:{type:"primary"},on:{click:t.handleAdd}},[a("Icon",{attrs:{type:"md-add"}})],1),a("Button",{attrs:{type:"primary"},on:{click:t.handleDelFake}},[a("Icon",{attrs:{type:"md-trash"}})],1)],1):a("td")])}))],2)])]:t._e()],2),a("div",{attrs:{slot:"footer"},slot:"footer"},[a("Button",{staticStyle:{"margin-left":"8px"},attrs:{type:"text"},on:{click:function(e){return t.$emit("input",!1)}}},[t._v(t._s(t._f("lang")("taxSet.cancel")))]),a("Button",{attrs:{type:"primary"},on:{click:function(e){return t.save()}}},[t._v(" "+t._s(t._f("lang")("taxSet.confirm")))])],1)],t.showSpin?a("Spin",{attrs:{size:"large",fix:""}}):t._e()],2)}),i=(a("0b92"),{props:{value:{default:!1,type:Boolean},item:{default:function(){},type:Object},opType:{default:"",type:String}},data:function(){return{showSpinBtn:!1,userSearched:null,userTable:!1,userType:{0:this.$t("official"),2:this.$t("test")},statusList:{11:this.$t("disabled"),41:this.$t("block"),31:this.$t("freeze"),10:this.$t("enabled"),21:"禁止抢单"},disabled:!1,showSpin:!1,status:1,title:"",typeList:[{label:this.$t("taxSet.member"),value:0},{label:this.$t("taxSet.proxy"),value:1},{label:this.$t("taxSet.level"),value:2}],isRequiredLevel:!1,isRequiredAccount:!0,isRequiredType:!0,formValueRule:{type:[{type:"number",required:this.isRequiredType,message:"请选择类型",trigger:"blur"}],rankLevel:[{type:"number",required:this.isRequiredLevel,message:"请选择等级",trigger:"blur"}],account:[{type:"string",required:this.isRequiredAccount,message:"请填写账户",trigger:"blur"}]},levelList:[],formValue:{type:"",account:""},taxSetList:[],paramsObj:{},userId:"",isEmpty:!1}},methods:{keydown:function(t){13!==t.keyCode||t.shiftKey||window.hasEnterEvent||this.save()},getTaxSet:function(){var t=this;this.$get("/platform/taxConfig/tob/getTaxConfig").then((function(e){var a=e.levels;t.levelList=a})).catch((function(e){t.$Message.error(e.message)})).finally((function(){}))},getTaxSetList:function(){var t=this;this.showSpin=!0,"2"==this.item.type?this.paramsObj.param=this.item.rankLevel:this.paramsObj.param=this.item.userId,this.$get("/platform/taxConfig/tob/getTaxConfigByType",{param:this.paramsObj.param,type:this.item.type}).then((function(e){var a=e.configs;t.taxSetList=a.map((function(t){return t.minMoney=+t.minMoney,t.maxMoney=+t.maxMoney,t}))})).catch((function(e){t.$Message.error(e.message)})).finally((function(){t.showSpin=!1}))},save:function(){var t=this;if(!this.showSpin){var e;e="add"==this.opType?"/platform/taxConfig/tob/batchAddTaxConfig":"/platform/taxConfig/tob/batchEditTaxConfig",this.formValue.type<2&&!this.formValue.account?this.$Message.error(this.$t("taxSet.errorTips10")):(this.taxSetList.map((function(e){e.minMoney&&e.maxMoney&&null!=e.memberTaxRate&&null!=e.platformTaxRate||(t.isEmpty=!0,t.$Message.error(t.$t("taxSet.errorTips2")))})),this.isEmpty?setTimeout((function(){t.isEmpty=!1}),10):(this.showSpin=!0,this.$refs.formValue.validate((function(a){if(a){t.showSpin=!0;var s={config:t.taxSetList};t.formValue.type<2?(s.type=t.formValue.type,s.account=t.formValue.account,s.userId=t.userId||t.item.userId):(s.type=t.formValue.type,s.rankLevel=t.formValue.rankLevel),t.$post(e,s,{"Content-type":"application/json;charset=UTF-8"}).then((function(){t.$Message.success(t.$t("modifySuccess")),t.$emit("save"),t.$emit("input",!1)})).catch((function(e){"20084"==e.code?t.$Message.error(t.$t("taxSet.errorTips9")):"20086"==e.code?t.$Message.error(t.$t("taxSet.errorTips4")):"20087"==e.code?t.$Message.error(t.$t("taxSet.errorTips5")):"20088"==e.code?t.$Message.error(t.$t("taxSet.errorTips6")):"20089"==e.code?t.$Message.error(t.$t("taxSet.errorTips7")):"20091"==e.code&&t.$Message.error(t.$t("taxSet.errorTips8"))})).finally((function(){t.showSpin=!1,t.showSpin=!1}))}else t.showSpin=!1}))))}},handleChange:function(){var t=this;this.formValue.type<2?(this.userTable=!1,this.userSearched=null,this.isEmpty=!1,setTimeout((function(){t.$refs.account.isRequired=!0}),10)):(this.getTaxSet(),this.formValue.rankLevel=1,this.isEmpty=!1,this.userTable=!0,this.userSearched&&(this.userSearched=null),setTimeout((function(){t.$refs.rankLevel.isRequired=!0,t.$refs.params.isRequired=!0}),10))},handleAdd:function(){this.taxSetList.push({maxMoney:null,memberTaxRate:null,minMoney:null,platformTaxRate:null,rankLevel:null})},handleDelFake:function(){"add"==this.opType?this.taxSetList.length>1&&(this.taxSetList.pop(),this.isEmpty=!1):(this.taxSetList.pop(),this.isEmpty=!1)},queryUserName:function(){var t=this;if(!this.showSpinBtn){if(this.showSpinBtn=!0,!this.formValue.account)return this.$Message.error(this.$t("fundManager.queryNameTip")),void(this.showSpinBtn=!1);this.showSpin=!0,this.$post("/user/tob/getUserDetailByName",{userName:this.formValue.account}).then((function(e){t.userSearched=e,t.userTable=!0,t.batchInfo=null,t.userId=e.id,setTimeout((function(){t.$refs.params.isRequired=!0}),10)})).catch((function(e){t.$Message.error(t.$t("taxSet.errorTips1"))})).finally((function(){t.showSpin=!1,setTimeout((function(){t.showSpinBtn=!1}),1e3)}))}}},mounted:function(){},computed:{value2:{get:function(){return this.value},set:function(t){this.$emit("input",t)}}},watch:{value:function(t){var e=this;t?("add"==this.opType?(this.title=this.$t("taxSet.newTax"),setTimeout((function(){e.$refs.account.isRequired=!0,e.$refs.type.isRequired=!0}),10),this.disabled=!1,this.formValue={type:0,rankLevel:"",account:""},this.userSearched=null,this.userTable=!1,this.getTaxSet(),this.taxSetList=[],this.taxSetList.push({minMoney:null,maxMoney:null,memberTaxRate:null,platformTaxRate:null})):(this.title=this.$t("taxSet.editTax"),setTimeout((function(){e.$refs.type.isRequired=!1,e.$refs.account.isRequired=!1,e.$refs.rankLevel.isRequired=!1,e.$refs.params.isRequired=!1}),10),this.isRequiredType=!1,this.getTaxSetList(),this.userSearched=null,this.userTable=!0,this.formValue=JSON.parse(JSON.stringify(this.item)),this.disabled=!0),document.addEventListener("keydown",this.keydown)):document.removeEventListener("keydown",this.keydown)}}}),n=i,r=(a("2771"),a("2877")),o={data:function(){return{showModal:!1,orderField:1,taxSetList:[],value1:1,value10:50,loading:!1,item:{},opType:""}},methods:{getTaxSet:function(){var t=this;this.loading=!0,this.$get("/platform/taxConfig/tob/getTaxConfig").then((function(e){var a=e.configs;t.taxSetList=[],t.taxSetList=a.map((function(t){return t.minMoney=+t.minMoney,t.maxMoney=+t.maxMoney,t}))})).catch((function(e){t.$Message.error(e.message)})).finally((function(){t.loading=!1}))},showType:function(t){return"0"==t?this.$t("roomManage.member"):"1"==t?this.$t("roomManage.proxyLines"):"2"==t?this.$t("userReport.levels"):void 0},handleAdd:function(){this.opType="add",this.showModal=!0},handleEdit:function(t){this.opType="edit",this.item=t,this.showModal=!0},handleDel:function(t){var e=this;this.loading=!0,this.$post("/platform/taxConfig/tob/delTaxConfig",{id:t.id}).then((function(){e.getTaxSet(),e.$Message.success(e.$t("modifySuccess"))})).catch((function(t){e.$Message.error(t.message)})).finally((function(){e.loading=!1}))},save:function(){this.getTaxSet()}},mounted:function(){this.getTaxSet()},components:{editTax:Object(r.a)(n,s,[],!1,null,"18c4e8b7",null).exports}},l=o,u=(a("3618"),Object(r.a)(l,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[t.loading?a("Spin",{attrs:{fix:""}}):t._e(),t.pageauthoritys.add?a("Button",{staticStyle:{margin:"10px 0"},attrs:{type:"primary"},on:{click:t.handleAdd}},[a("Icon",{attrs:{type:"md-add"}}),t._v(t._s(t._f("lang")("fm.add"))+" ")],1):t._e(),a("table",{staticClass:"cmtable tdcenter"},[a("tr",[a("th",[t._v(t._s(t._f("lang")("fund.type")))]),a("th",[t._v(t._s(t._f("lang")("siteConfig.taxSetTable1")))]),a("th",[t._v(t._s(t._f("lang")("fm.userAccount")))]),a("th",[t._v(t._s(t._f("lang")("siteConfig.taxSetTable2")))]),a("th",[t._v(t._s(t._f("lang")("siteConfig.taxSetTable3")))]),a("th",[t._v(t._s(t._f("lang")("siteConfig.taxSetTable4")))]),a("th",[t._v(" "+t._s(t._f("lang")("fund.operate"))+" ")])]),t._l(t.taxSetList,(function(e,s){return a("tr",{key:s},[a("td",[t._v(t._s(t.showType(e.type)))]),a("td",[t._v(" "+t._s(e.rankLevel||"-")+" ")]),a("td",[t._v(" "+t._s(e.account||"-")+" ")]),a("td",[t._v(" "+t._s(e.minMoney)+" ~ "+t._s(e.maxMoney)+" ")]),a("td",[t._v(" "+t._s(e.memberTaxRate)+"% ")]),a("td",[t._v(" "+t._s(e.platformTaxRate)+"% ")]),a("td",[t.pageauthoritys.edit?a("Button",{staticStyle:{margin:"0 10px"},on:{click:function(a){return t.handleEdit(e)}}},[t._v(" "+t._s(t._f("lang")("fund.edit"))+" ")]):t._e()],1)])}))],2),a("editTax",{attrs:{item:t.item,opType:t.opType},on:{save:function(e){return t.save()}},model:{value:t.showModal,callback:function(e){t.showModal=e},expression:"showModal"}})],1)}),[],!1,null,"1f456384",null));e.default=u.exports},ab81:function(t,e,a){}}]);