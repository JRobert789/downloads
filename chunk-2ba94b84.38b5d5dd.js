(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-2ba94b84"],{"05ee":function(t,e,a){"use strict";a.r(e);var s=(a("d3b7"),a("159b"),a("b64b"),a("caad"),a("d81d"),a("b680"),function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("Drawer",{attrs:{closable:!1,width:"1000"},model:{value:t.show,callback:function(e){t.show=e},expression:"show"}},[a("div",{staticClass:"drawer"},[a("div",{staticClass:"top"},[a("div",{staticClass:"title"},[a("h2",[t._v(t._s(t.$t("report.Details")))]),a("span",{staticClass:"close"},[a("Icon",{attrs:{size:"30",type:"md-close"},on:{click:t.close}})],1)]),a("div",{staticClass:"options"},[a("div",{staticClass:"item"},[a("span",[t._v(t._s(t.$t("report.dateRange"))+" ")]),a("DatePicker",{staticStyle:{width:"240px"},attrs:{options:t.dateOptions,type:"daterange",placement:"bottom-start"},model:{value:t.dateList,callback:function(e){t.dateList=e},expression:"dateList"}})],1),a("div",{staticClass:"item"},[a("span",[t._v(t._s(t.$t("report.Usernamequery"))+"： ")]),a("Input",{staticStyle:{width:"200px"},attrs:{placeholder:t.$t("fund.pleaseInput")},model:{value:t.username,callback:function(e){t.username=e},expression:"username"}})],1),a("div",{staticClass:"item"},[a("Button",{attrs:{type:"primary"},on:{click:t.searchHandler}},[t._v(t._s(t.$t("search")))])],1)])]),a("div",{staticClass:"mtable"},[a("table",{staticClass:"cmtable"},[a("thead",[a("tr",[a("th",{staticStyle:{"text-align":"left"},attrs:{colspan:t.columns.length}},[t._v(" "+t._s(t.$t("proxy.pathUrl"))+": "),a("span",{staticStyle:{color:"#2d8cf0"}},[t._v(t._s(t.value.roomName))])])]),a("tr",t._l(t.columns,(function(e){return a("th",{key:e.key},[t._v(" "+t._s(e.text)+" ")])})),0)]),a("tbody",t._l(t.list,(function(e,s){return a("tr",{key:s},t._l(t.columns,(function(s){return a("td",{key:s.key},[t._v(" "+t._s(e[s.key])+" ")])})),0)})),0)])]),a("div",{staticClass:"bottom"},[a("m-page",{attrs:{total:+t.total,pageSizeOpts:t.pageSizeArray,pageSize:+t.size},on:{"on-change":t.getData,"on-page-size-change":t.pageSizeChange},model:{value:t.page,callback:function(e){t.page=e},expression:"page"}})],1)]),t.loading?a("Spin",{attrs:{size:"large",fix:""}}):t._e()],1)}),n=a("2909"),o=a("a8e2"),i={props:{teamUsername:String,value:{type:Object,default:function(){return{}}},dates:{type:Array,default:function(){return[new Date,new Date]}}},data:function(){return{columns:[{key:"username",text:this.$t("report.username")},{key:"completedOrderAmount",text:this.$t("report.orderAmount")},{key:"completedOrderCount",text:this.$t("report.orderCount")},{key:"commissionAmount",text:this.$t("report.commission")}],username:"",size:20,page:1,dateOptions:o.a,list:[],pageSizeArray:[20,30,50],total:0,loading:!1,dateList:this.$utils.getTodayArr()}},methods:{pageSizeChange:function(t){this.size=t,this.list=[],this.getData(1)},searchHandler:function(){this.list=[],this.getData(1)},close:function(){this.$emit("input",{})},getData:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;if(!this.loading){this.loading=!0;var a={beginTime:this.$utils.formatDate(this.dateList[0],"YYYY-MM-DD")+" 00:00:00",endTime:this.$utils.formatDate(this.dateList[1],"YYYY-MM-DD")+" 23:59:59",page:this.page=e,roomId:this.value.roomId,size:this.size};this.teamUsername&&(a.teamUsername=this.teamUsername),this.username&&(a.username=this.username),this.$get("/report/tob/pageRoomUserReport",a).then((function(e){var a=e.content,s=e.totalElements;t.list=a.map((function(t){return Object.keys(t).forEach((function(e){/Amount$/.test(e)&&(t[e]=((+t[e]||0)/100).toFixed(2))})),t})),t.total=+s})).finally((function(){t.loading=!1}))}}},computed:{show:{get:function(){return!!this.value.roomId},set:function(){this.close()}}},watch:{show:function(t){t&&(this.dateList=Object(n.a)(this.dates),this.getData())}}},r=i,u=(a("0865"),a("2877")),c={data:function(){return{dates:this.$utils.getTodayArr(),teamUsername:"",dateOptions:this.$utils.genDateConfig(90),columns:[{key:"roomName",title:this.tfn("roomName"),slot:"room"},{key:"grabUserCount",title:this.tfn("grabCount")},{key:"completedOrderAmount",title:this.tfn("orderAmount")},{key:"completedOrderCount",title:this.tfn("orderCount")},{key:"commissionAmount",title:this.tfn("commission")}],size:10,list:[],loading:!1,roomData:{}}},mounted:function(){this.getData()},components:{drawer:Object(u.a)(r,s,[],!1,null,"5d2a2c7e",null).exports},methods:{tfn:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.$t("report.".concat(t),e)},getRoomInfo:function(t){this.roomData=t},searchHandler:function(){this.list=[],this.getData(1)},pageSizeChange:function(t){this.size=t,this.list=[],this.getData()},getData:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;if(!this.loading){this.loading=!0;var a={page:this.page=e,size:this.size,beginTime:this.$utils.formatDate(this.dates[0],"YYYY-MM-DD")+" 00:00:00",endTime:this.$utils.formatDate(this.dates[1],"YYYY-MM-DD")+" 23:59:59"};this.teamUsername&&(a.teamUsername=this.teamUsername),this.$get("/report/tob/getRoomReport",a).then((function(e){if(e&&e.length&&e.length>1){var a=["canceledOrderAmount","canceledOrderCount","commissionAmount","completedOrderAmount","completedOrderCount","grabUserCount","orderCount","realTimeTeamCommissionAmount","teamCommissionAmount"],s=e.reduce((function(t,e){return Object.keys(e).forEach((function(s){a.includes(s)&&(t[s]||(t[s]=0),t[s]+=+e[s])})),t}),{roomName:t.tfn("subtotal"),isTotal:!0});e.push(s)}t.list=e.map((function(t){return Object.keys(t).forEach((function(e){/Amount$/.test(e)&&(t[e]=((+t[e]||0)/100).toFixed(2))})),t}))})).catch((function(e){t.list=[],t.$Message.error(e.message)})).finally((function(){t.loading=!1}))}}}},l=c,d=(a("c548"),Object(u.a)(l,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("m-layout",{staticClass:"room_report",attrs:{nav:[{name:"房间报表",path:"/roomReport"}]}},[a("div",{staticClass:"search"},[a("div",{staticClass:"search_item"},[a("span",[t._v(t._s(t.tfn("teamQuery"))+" ")]),a("Input",{staticStyle:{width:"200px"},attrs:{placeholder:t.tfn("inputTip")},model:{value:t.teamUsername,callback:function(e){t.teamUsername=e},expression:"teamUsername"}})],1),a("div",{staticClass:"search_item"},[a("DatePicker",{staticStyle:{width:"240px"},attrs:{options:t.dateOptions,type:"daterange",placement:"bottom-end"},model:{value:t.dates,callback:function(e){t.dates=e},expression:"dates"}})],1),a("Button",{attrs:{type:"primary",icon:"ios-search"},on:{click:t.searchHandler}},[t._v(t._s(t._f("lang")("search")))])],1),a("div",{staticClass:"label"},[a("m-table",{attrs:{columns:t.columns,data:t.list},scopedSlots:t._u([{key:"room",fn:function(e){var s=e.row;return[s.isTotal?a("span",[t._v(t._s(s.roomName))]):a("span",{staticClass:"item_btn",on:{click:function(e){return t.getRoomInfo(s)}}},[t._v(t._s(s.roomName))])]}}])})],1),a("div",{staticClass:"label"},[a("h4",[t._v(t._s(t.tfn("roomReportTip")))])]),t.loading?a("Spin",{attrs:{size:"large",fix:""}}):t._e(),a("drawer",{attrs:{teamUsername:t.teamUsername,dates:t.dates},model:{value:t.roomData,callback:function(e){t.roomData=e},expression:"roomData"}})],1)}),[],!1,null,null,null));e.default=d.exports},"0865":function(t,e,a){"use strict";a("84be")},"84be":function(t,e,a){},a8e2:function(t,e,a){"use strict";a.d(e,"a",(function(){return i})),a.d(e,"b",(function(){return r})),a.d(e,"c",(function(){return u}));var s=a("3835"),n=(a("b680"),a("d36b")),o=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return n.a.t("report.".concat(t),e)},i={shortcuts:[{ttext:n.a.t("fund.today"),code:"today",value:function(){var t=new Date;t.setHours(0),t.setMinutes(0),t.setSeconds(0);var e=new Date;return e.setHours(23),e.setMinutes(59),e.setSeconds(59),[new Date(t),e]}},{text:n.a.t("fund.yesterday"),code:"yesterday",value:function(){var t=new Date;t.setTime(t.getTime()-864e5),t.setHours(0),t.setMinutes(0),t.setSeconds(0);var e=new Date(t);return e.setHours(23),e.setMinutes(59),e.setSeconds(59),[t,e]}},{text:n.a.t("fund.thisweek"),code:"week",value:function(){var t=new Date,e=t.getDay()||7,a=new Date(t-864e5*(e-1));return a.setHours(0),a.setMinutes(0),a.setSeconds(0),[a,new Date]}},{text:n.a.t("fund.lastweek"),code:"lastWeek",value:function(){var t=new Date,e=t.getDay()||7,a=864e5,s=new Date(t-e*a),n=new Date(t-(e+6)*a);return n.setHours(0),n.setMinutes(0),n.setSeconds(0),s.setHours(23),s.setMinutes(59),s.setSeconds(59),[n,s]}},{text:n.a.t("fund.thismonth"),code:"month",value:function(){var t=new Date;t.setDate(1);var e=new Date(t);e.setHours(0),e.setMinutes(0),e.setSeconds(0);var a=new Date;return a.setHours(23),a.setMinutes(59),a.setSeconds(59),[e,a]}},{text:n.a.t("nearlySevenDays"),value:function(){var t=new Date,e=new Date;return t.setHours(23),t.setMinutes(59),t.setSeconds(59),e.setHours(0),e.setMinutes(0),e.setSeconds(0),e.setTime(e.getTime()-5184e5),[e,t]}},{text:n.a.t("nearly15Days"),value:function(){var t=new Date,e=new Date;return t.setHours(23),t.setMinutes(59),t.setSeconds(59),e.setHours(0),e.setMinutes(0),e.setSeconds(0),e.setTime(e.getTime()-12096e5),[e,t]}},{text:n.a.t("nearly30Days"),value:function(){var t=new Date,e=new Date;return t.setHours(23),t.setMinutes(59),t.setSeconds(59),e.setHours(0),e.setMinutes(0),e.setSeconds(0),e.setTime(e.getTime()-25056e5),[e,t]}}],disabledDate:function(t){return t&&t.valueOf()>Date.now()||t.valueOf()<Date.now()-15552e6}},r=(n.a.t("fund.today"),n.a.t("fund.yesterday"),n.a.t("fund.lastweek"),n.a.t("fund.thismonth"),n.a.t("fund.lastmonth"),n.a.t("nearlySevenDays"),n.a.t("nearly15Days"),n.a.t("nearly30Days"),n.a.t("fund.today"),n.a.t("fund.yesterday"),n.a.t("fund.last7"),n.a.t("fund.thismonth"),n.a.t("fund.lastmonth"),[{key:"0",name:o("decrease")},{key:"1",name:o("increase")}]);function u(t){var e,a=Object(s.a)(t,2),n=a[0],o=a[1];return n=Date.parse(n),e=(o=Date.parse(o))-n,e=Math.abs(e),Math.floor(e/864e5)>30}},c548:function(t,e,a){"use strict";a("d2ca")},d2ca:function(t,e,a){}}]);