(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-e0fcbba8"],{"085f":function(e,t,a){"use strict";a("77bc")},"77bc":function(e,t,a){},e90a:function(e,t,a){"use strict";a.r(t);var r=(a("d3b7"),{name:"bankinfo",data:function(){return{form:{cardUserName:"",bankName:"",bankProvince:"",bankCity:"",netAddr:"",cardNo:"",ifscCode:"",email:"",phone:"",isDefault:"0"},rule:{cardNo:[{required:!0,message:"请输入银行卡号",trigger:"blur"},{pattern:/(^\d{1,50}$)/,message:"请输入1~50位数字的银行卡号",trigger:"blur"}],bankName:[{required:!0,message:"请输入银行名称",trigger:"blur"}],bankCity:[{required:!0,message:"请输入所在城市",trigger:"blur"}],email:[{required:!0,message:"请输入邮箱",trigger:"blur"},{pattern:/^[A-Za-z0-9\u4e00-\u9fa5]+@[a-zA-Z0-9_-]+(\.[a-zA-Z0-9_-]+)+$/,message:"请输入正确的邮箱, 如 123@qq.com",trigger:"blur"}],ifscCode:[{required:!1,message:"请输入SWFITCode",trigger:"blur"},{pattern:/^[A-Za-z0-9]{8,11}$/,message:"请输入正确的SWFITCode，8-11位英文、数字或组合",trigger:"blur"}],phone:[{required:!0,message:"请输入手机号",trigger:"blur"}],cardUserName:[{required:!0,message:"请输入姓名",trigger:"blur"},{pattern:/^(?!.*(·|\s)\1)([\u4e00-\u9fa5][\u4e00-\u9fa5·]{0,126}[\u4e00-\u9fa5]|[a-zA-Z][a-zA-Z·\s]{0,126}[a-zA-Z])$/,message:"姓名必须为纯中文或英文，长度须为2-128位。",trigger:"blur"}]},dataList:[],open:!1,pageConfig:null,cityList:[],editObj:{},loading2:!1}},computed:{userName:function(){return this.pageConfig&&this.pageConfig.userModel.userName},isTest:function(){return this.$route.query.isTest},pageauthoritys:function(){return this.buttonMap["/userdetail/bankinfo"]||{}}},methods:{getStatus:function(e){return e.isEnable?0==e.isDefault?"未锁定":1==e.isDefault?"锁定":"已锁定":"已禁用"},edit:function(e){this.form={cardUserName:e.cardUserName,bankName:e.bankName,bankProvince:e.bankProvince,bankCity:e.bankCity,netAddr:e.netAddr,cardNo:e.cardNo,ifscCode:e.ifscCode,email:e.email,phone:e.phone,isDefault:e.isDefault+""},this.editObj=e,this.open=!0},getPageConfig:function(){var e=this,t=this.isTest?"/user/lotTestUser/selectUserBankApi":"/user/lotUser/selectUserBankApi";this.$get(t,{userId:this.$route.query.userid}).then((function(t){e.pageConfig=t}))},getBankList:function(){var e=this;this.$get("/user/bank/queryUserBankApi",{userId:this.$route.query.userid}).then((function(t){e.dataList=t.resultList})).catch((function(){e.$Message.error("获取银行卡列表失败, 请刷新页面重试")}))},handleSubmit:function(e){var t=this;this.$refs[e].validate((function(e){e?t.addbankcard():t.$Message.error("请确认字段填写正确!")}))},addbankcard:function(){var e=this;this.loading2=!0;var t=this.editObj.id?"/user/bank/updateUserIndiaBank":"/user/bank/saveUserIndiaBank";this.$post(t,{userId:this.$route.query.userid,id:this.editObj.id||"",cardUserName:this.form.cardUserName,bankName:this.form.bankName,bankProvince:this.form.bankProvince,bankCity:this.form.bankCity,netAddr:this.form.netAddr,cardNo:this.form.cardNo,ifscCode:this.form.ifscCode,email:this.form.email,phone:this.form.phone,isDefault:this.form.isDefault+""}).then((function(){var t=e.editObj.id?e.$t("changeSuccess"):"添加成功";e.$Message.success(t),e.getBankList(),e.open=!1,e.onclose()})).catch((function(t){e.$Message.error(t.message)})).finally((function(){e.loading2=!1}))},updateBankStatus:function(e,t){var a=this;this.$Modal.confirm({title:"是否确定".concat(+t?"启用":"禁用"),onOk:function(){a.$post("/user/bank/updateUserBankStatus",{userBankId:e,status:t}).then((function(){a.$Message.success(a.$t("changeSuccess")),a.getBankList()})).catch((function(e){a.$Message.error(e.message)}))}})},deletebank:function(e){var t=this;this.$post("/user/bank/deleteUserBank",{userBankId:e}).then((function(){t.$Message.success("删除成功"),t.getBankList()})).catch((function(e){t.$Message.error(e.message)}))},onclose:function(){this.form={cardUserName:"",bankName:"",bankProvince:"",bankCity:"",netAddr:"",cardNo:"",ifscCode:"",email:"",phone:"",isDefault:"0"},this.editObj={}},getCity:function(){var e=this;this.$get("/sys/lotSysArea/tob/getCity",{areaId:this.form.provinceId}).then((function(t){e.cityList=t,e.cityList.every((function(t){return t.id!==e.form.cityId}))&&(e.form.cityId="")}))}},mounted:function(){this.getPageConfig(),this.getBankList()}}),n=r,s=(a("085f"),a("2877")),i=Object(s.a)(n,(function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"bankinfo"},[a("div",[e._v("玩家账号: "+e._s(e.userName))]),a("div",{staticStyle:{margin:"20px 0"}},[e.pageauthoritys.add?a("Button",{attrs:{type:"primary",icon:"ios-add"},on:{click:function(t){e.open=!0}}},[e._v("添加银行卡")]):e._e()],1),a("table",{staticClass:"cmtable tdcenter"},[e._m(0),e._l(e.dataList,(function(t,r){return a("tr",{key:r},[a("td",[e._v(e._s(t.cardUserName))]),a("td",[e._v(e._s(t.cardNo))]),a("td",[e._v(e._s(t.bankName))]),a("td",[e._v(e._s(t.phone))]),a("td",[e._v(e._s(t.ifscCode))]),a("td",[e._v(e._s(t.email))]),a("td",[e._v(e._s(t.province))]),a("td",[e._v(e._s(t.city))]),a("td",[e._v(e._s(t.netAddr))]),a("td",[e._v(e._s(e.getStatus(t)))]),a("td",[e.pageauthoritys.updateEnableStatus?a("Button",{on:{click:function(a){return e.updateBankStatus(t.id,t.isEnable?"0":"1")}}},[e._v(e._s(t.isEnable?"禁用":"启用"))]):e._e(),e._v("   "),e.pageauthoritys.update?a("Button",{on:{click:function(a){return e.edit(t)}}},[e._v("编辑")]):e._e(),e._v("  "),e.pageauthoritys.delete?a("Poptip",{attrs:{transfer:"",confirm:"",title:"确认删除银行卡？"},on:{"on-ok":function(a){return e.deletebank(t.id)}}},[a("Button",[e._v("删除")])],1):e._e()],1)])})),e.dataList.length?e._e():a("tr",[a("td",{attrs:{colspan:"11"}},[e._v(e._s(e.$t("Nodata")))])])],2),a("Drawer",{staticClass:"noctxpad",attrs:{"mask-closable":!1,width:"500",closable:"",title:this.editObj.id?"修改银行卡":"添加银行卡"},on:{"on-close":function(t){return e.onclose()}},model:{value:e.open,callback:function(t){e.open=t},expression:"open"}},[e.loading2?a("Spin",{attrs:{fix:""}}):e._e(),a("div",{staticClass:"bankform"},[a("Form",{ref:"form",attrs:{model:e.form,rules:e.rule,"label-width":100}},[a("FormItem",{attrs:{prop:"bankName",label:"银行名称"}},[e.pageConfig?a("Select",{attrs:{placeholder:"选择银行",filterable:""},model:{value:e.form.bankName,callback:function(t){e.$set(e.form,"bankName",t)},expression:"form.bankName"}},e._l(e.pageConfig.sysBankMap,(function(t,r){return a("OptionGroup",{key:r,attrs:{label:(e.pageConfig.bankRegionMap||{})[r]||"其他"}},[e._l(t,(function(t){return e._l(t,(function(t){return a("Option",{key:t,attrs:{value:t}},[e._v(e._s(t))])}))}))],2)})),1):e._e()],1),a("FormItem",{attrs:{prop:"cardUserName",label:"收款人姓名"}},[a("Input",{model:{value:e.form.cardUserName,callback:function(t){e.$set(e.form,"cardUserName",t)},expression:"form.cardUserName"}})],1),a("FormItem",{attrs:{prop:"cardNo",label:"银行卡号"}},[a("Input",{model:{value:e.form.cardNo,callback:function(t){e.$set(e.form,"cardNo",t)},expression:"form.cardNo"}})],1),a("FormItem",{attrs:{prop:"bankCity",label:"所属城市"}},[a("Input",{model:{value:e.form.bankCity,callback:function(t){e.$set(e.form,"bankCity",t)},expression:"form.bankCity"}})],1),a("FormItem",{attrs:{prop:"ifscCode",label:"SWFITCODE"}},[a("Input",{model:{value:e.form.ifscCode,callback:function(t){e.$set(e.form,"ifscCode",t)},expression:"form.ifscCode"}})],1),a("FormItem",{attrs:{prop:"email",label:"邮箱"}},[a("Input",{model:{value:e.form.email,callback:function(t){e.$set(e.form,"email",t)},expression:"form.email"}})],1),a("FormItem",{attrs:{prop:"phone",label:"手机号码"}},[a("Input",{model:{value:e.form.phone,callback:function(t){e.$set(e.form,"phone",t)},expression:"form.phone"}})],1),a("FormItem",{attrs:{prop:"bankProvince",label:"银行省份"}},[a("Input",{model:{value:e.form.bankProvince,callback:function(t){e.$set(e.form,"bankProvince",t)},expression:"form.bankProvince"}})],1),a("FormItem",{attrs:{prop:"netAddr",label:"支行地址"}},[a("Input",{model:{value:e.form.netAddr,callback:function(t){e.$set(e.form,"netAddr",t)},expression:"form.netAddr"}})],1),e.editObj.id?a("FormItem",{attrs:{prop:"isDefault",label:"状态"}},[a("Select",{model:{value:e.form.isDefault,callback:function(t){e.$set(e.form,"isDefault",t)},expression:"form.isDefault"}},[a("Option",{attrs:{value:"0"}},[e._v("未锁定")]),a("Option",{attrs:{value:"1"}},[e._v("锁定")]),a("Option",{attrs:{value:"2"}},[e._v("已锁定")])],1)],1):e._e()],1)],1),a("div",{staticClass:"drawerbottom"},[a("Button",{attrs:{type:"primary"},on:{click:function(t){return e.handleSubmit("form")}}},[e._v("确定")])],1)],1)],1)}),[function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("tr",[a("th",[e._v("持卡人姓名")]),a("th",[e._v("卡号")]),a("th",[e._v("银行信息")]),a("th",[e._v("手机号")]),a("th",[e._v("SWFITCODE")]),a("th",[e._v("邮箱")]),a("th",[e._v("所在省")]),a("th",[e._v("所在市")]),a("th",[e._v("支行")]),a("th",[e._v("状态")]),a("th",[e._v("操作")])])}],!1,null,null,null);t.default=i.exports}}]);