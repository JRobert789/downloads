(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-478f2ef0"],{"5ac6":function(e,t,s){},a897:function(e,t,s){"use strict";var n=(s("ac1f"),s("5319"),s("d3b7"),s("25f0"),{name:"ckeditor4",props:["value","handleShowChange"],mounted:function(){var e=this;e.ckeditor=window.CKEDITOR.replace(e.id),e.ckeditor.setData(e.value),e.ckeditor.config.language=this.$i18n.locale.toLowerCase(),e.ckeditor.config.filebrowserImageUploadUrl="/api/watermelon/commonUpload/tob/upload",e.ckeditor.config.image_previewText=" ",e.ckeditor.on("change",(function(){e.$emit("input",e.ckeditor.getData())})),e.ckeditor.on("blur",(function(t){e.$emit("on-blur",t)})),e.ckeditor.on("fileUploadResponse",(function(e){e.stop();var t=e.data,s=t.fileLoader.xhr,n=JSON.parse(s.responseText);t.url=n.data.url}))},data:function(){return{id:parseInt(1e4*Math.random()).toString(),ckeditor:null}},watch:{value:function(){this.value!==this.ckeditor.getData()&&this.ckeditor.setData(this.value)},handleShowChange:function(){this.ckeditor.setReadOnly(this.handleShowChange)}},beforeDestroy:function(){this.ckeditor.destroy()}}),a=n,i=s("2877"),o=Object(i.a)(a,(function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",[s("textarea",{attrs:{id:e.id,disabled:e.handleShowChange}})])}),[],!1,null,null,null);t.a=o.exports},dc16:function(e,t,s){"use strict";s.r(t);var n=(s("d3b7"),function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("Drawer",{attrs:{width:"1200"},model:{value:e.value2,callback:function(t){e.value2=t},expression:"value2"}},[e.loading?s("Spin",{attrs:{fix:""}}):e._e(),s("Form",{ref:"form",attrs:{model:e.form,"label-width":200,rules:e.rule}},[s("FormItem",{attrs:{label:e.tFn("announcementTitle"),prop:"title"}},[s("Input",{staticClass:"width-200",attrs:{maxlength:"50"},model:{value:e.form.title,callback:function(t){e.$set(e.form,"title",t)},expression:"form.title"}})],1),s("FormItem",{attrs:{label:e.tFn("sort"),prop:"orderId"}},[s("InputNumber",{staticClass:"width-200",attrs:{max:999},model:{value:e.form.orderId,callback:function(t){e.$set(e.form,"orderId",t)},expression:"form.orderId"}})],1),s("FormItem",{attrs:{label:e.tFn("timeRange"),prop:"time"}},[s("DatePicker",{staticClass:"width-200 m-r-20",attrs:{transfer:!0,clearable:!1,type:"datetimerange",format:"yyyy-MM-dd HH:mm:ss",placement:"bottom-end",placeholder:e.tFn("pleaseSelectADate")},on:{"on-change":e.setTimeRange},model:{value:e.form.time,callback:function(t){e.$set(e.form,"time",t)},expression:"form.time"}})],1),s("FormItem",{attrs:{label:e.tFn("whetherToLoginPopUp"),prop:"loginPop"}},[s("i-switch",{attrs:{size:"large"},model:{value:e.form.loginPop,callback:function(t){e.$set(e.form,"loginPop",t)},expression:"form.loginPop"}},[s("span",{attrs:{slot:"open"},slot:"open"},[e._v(e._s(e._f("lang")("enabled")))]),s("span",{attrs:{slot:"close"},slot:"close"},[e._v(e._s(e._f("lang")("disabled")))])])],1),s("FormItem",{attrs:{label:e.tFn("userType"),prop:"userType"}},[s("Select",{staticClass:"width-200",on:{"on-change":e.change},model:{value:e.form.userType,callback:function(t){e.$set(e.form,"userType",t)},expression:"form.userType"}},e._l(e.userTypeList,(function(t){return s("Option",{key:t.value,attrs:{value:t.value}},[e._v(e._s(t.label))])})),1),0!=e.form.userType?s("div",{staticClass:"noticetypegroup"},e._l(e.ids,(function(t,n){return s("span",{key:n,class:{active:e.usergroupsselected.has(n)},on:{click:function(t){return e.fn(n)}}},[e._v(e._s(n))])})),0):e._e()],1),s("FormItem",{attrs:{label:e.tFn("announcementContent"),prop:"content"}},[s("Editor",{staticStyle:{width:"800px"},attrs:{handleShowChange:e.handleShowChange},on:{"on-blur":e.handleBlur},model:{value:e.form.content,callback:function(t){e.$set(e.form,"content",t)},expression:"form.content"}})],1),s("FormItem",{attrs:{label:""}},[s("Button",{staticStyle:{"margin-right":"8px"},attrs:{type:"primary"},on:{click:function(t){return e.handleConfirm(!0)}}},[e._v(e._s(e._f("lang")("confirm")))]),s("Button",{on:{click:function(t){e.value2=!1}}},[e._v(e._s(e._f("lang")("cancel")))])],1)],1)],1)}),a=(s("6062"),s("3ca3"),s("ddb0"),s("a15b"),s("a630"),s("4de4"),s("ac1f"),s("1276"),s("a897")),i=s("ce26"),o={props:{value:{default:!1,type:Boolean},item:{default:null,type:Object},type:{default:"",type:String}},data:function(){return{loading:!1,form:{time:["",""]},handleShowChange:!1,userTypeList:[{value:0,label:this.tFn("AllUsers")},{value:1,label:this.tFn("userLevel")},{value:2,label:this.tFn("userHierarchy")}],rule:{title:[{type:"string",required:!0,message:this.tFn("pleaseFillInTheName"),trigger:"blur"}],orderId:[{required:!0,type:"number",message:this.tFn("pleaseEnterTheOrder"),trigger:"blur"},{pattern:/(^\d{1,3}$)/,message:this.tFn("pleaseEnterTheCorrectOrder"),trigger:"blur"}],time:[{type:"array",required:!0,fields:{0:{type:"date",required:!0,message:this.tFn("pleaseSelectTheStartAndEndDates")},1:{type:"date",required:!0,message:this.tFn("pleaseSelectTheStartAndEndDates")}}}],content:[{type:"string",required:!0,message:this.tFn("pleaseFillInTheContentOfTheAnnouncement"),trigger:"blur"}]},ids:[],usergroupsselected:new Set}},mounted:function(){},methods:{tFn:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.$t("systemManager.".concat(e),t)},handleBlur:function(){this.$refs.form.validateField("content")},fn:function(e){this.usergroupsselected.has(e)?this.usergroupsselected.delete(e):this.usergroupsselected.add(e),this.$forceUpdate()},change:function(e){var t=this;e&&0!=e&&this.$get("/pubmes/notice/tob/queryUserTypeDetail",{userType:e}).then((function(e){t.ids=e})).catch((function(e){t.$Message.error(e.message)})).finally((function(){}))},initDate:function(){var e=[Object(i.formatDate)(this.form.startTime,"YYYY-MM-DD hh:mm:ss"),Object(i.formatDate)(this.form.endTime,"YYYY-MM-DD hh:mm:ss")];this.setTimeRange(e)},setTimeRange:function(e){this.form.startTime=e[0],this.form.endTime=e[1],this.form.time=[this.form.startTime,this.form.endTime]},handleConfirm:function(){var e=this;"edit"==this.type?this.$refs.form.validate((function(t){if(t){e.loading=!0;var s=e.form;delete s.time,1==e.form.userType&&(s=Object.assign(e.form,{userTypeValues:Array.from(e.usergroupsselected).join(",")})),2==e.form.userType&&(s=Object.assign(e.form,{userTypeValues:Array.from(e.usergroupsselected).join(",")})),e.$post("/pubmes/notice/tob/updateById",s).then((function(){e.$Message.success(e.$t("opSuccess")),e.value2=!1,e.$emit("onSuccess")})).catch((function(t){e.$Message.error(t.message)})).finally((function(){e.loading=!1}))}})):this.$refs.form.validate((function(t){if(t){e.loading=!0;var s=e.form;delete s.time,1==e.form.userType&&(s=Object.assign(e.form,{userTypeValues:Array.from(e.usergroupsselected).join(",")})),2==e.form.userType&&(s=Object.assign(e.form,{userTypeValues:Array.from(e.usergroupsselected).join(",")})),e.$post("/pubmes/notice/tob/add",s).then((function(){e.$Message.success(e.$t("opSuccess")),e.value2=!1,e.$emit("onSuccess")})).catch((function(t){e.$Message.error(t.message)})).finally((function(){e.loading=!1}))}}))}},watch:{value:function(e){if(e)if("add"==this.type)this.$refs.form.resetFields(),this.form={orderId:null,userType:0,loginPop:!1,time:["",""]},this.usergroupsselected=new Set;else{if(this.form=JSON.parse(JSON.stringify(this.item)),this.form.userTypeValues){var t=this.form.userTypeValues.split(",").filter((function(e){return e}));this.usergroupsselected=new Set(t),this.change(this.form.userType)}this.initDate()}}},computed:{value2:{get:function(){return this.value},set:function(e){this.$emit("input",e)}}},components:{Editor:a.a}},r=o,l=(s("feed"),s("2877")),c={name:"frontNotice",data:function(){return{loading:!1,status:"",title:"",showAddNotice:!1,statusList:[{value:"0",label:this.$t("all")},{value:"1",label:this.$t("disabled")},{value:"2",label:this.$t("enabled")},{value:"3",label:this.tFn("expired")}],columns:[{title:this.tFn("subject"),key:"title"},{title:this.$t("createTime"),key:"createTime"},{title:this.$t("startTime"),key:"startTime"},{title:this.$t("endTime"),key:"endTime"},{title:this.$t("status"),slot:"status"},{title:this.tFn("whetherToLoginPopUp"),slot:"loginPop"},{title:this.tFn("sort"),key:"orderId"},{title:this.$t("operation"),key:"operation",slot:"action"}],dataList:[],editItem:{},editType:"",page:1,size:20,totalElements:0}},components:{addNotice:Object(l.a)(r,n,[],!1,null,null,null).exports},mounted:function(){this.query()},methods:{tFn:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.$t("systemManager.".concat(e),t)},clear:function(){this.title="",this.status=""},showStatus:function(e){return 0==e?this.$t("all"):1==e?this.$t("disabled"):2==e?this.$t("enabled"):3==e?this.tFn("expired"):void 0},showPop:function(e){return e?this.tFn("yes"):this.tFn("no")},add:function(){this.editType="add",this.showAddNotice=!0},pageSizeChange:function(e){this.size=e,this.query()},handleStatus:function(e){var t=this;return new Promise((function(s){t.$Modal.confirm({title:t.tFn("switch"),content:t.tFn("switchNoticeTip"),onOk:function(){t.loading=!0,t.$post("/pubmes/notice/tob/updateStatus",{id:e.id,status:e.enabled?1:2}).then((function(){t.query()})).catch((function(e){t.$Message.error(e.message)})).finally((function(){t.loading=!1}))}})}))},query:function(){var e=this;this.loading=!0,this.$get("/pubmes/notice/tob/queryPage",{pageIdx:this.page,pageSize:this.size,title:this.title,status:this.status}).then((function(t){e.dataList=t.content,e.totalElements=+t.totalElements})).catch((function(t){e.$Message.error(t.message)})).finally((function(){e.loading=!1}))},handleDel:function(e){var t=this;return new Promise((function(s){t.$Modal.confirm({title:t.$t("delete"),content:t.$t("deleteTip"),onOk:function(){t.loading=!0,t.$post("/pubmes/notice/tob/del",{id:e.id}).then((function(){t.$Message.success(t.$t("success")),t.query()})).catch((function(e){t.$Message.error(e.message)})).finally((function(){t.loading=!1}))}})}))},handleEdit:function(e){this.editType="edit",this.showAddNotice=!0,this.editItem=JSON.parse(JSON.stringify(e))}}},u=c,d=Object(l.a)(u,(function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",[e.loading?s("Spin",{attrs:{fix:""}}):e._e(),s("Select",{staticClass:"m-r-20 width-120",model:{value:e.status,callback:function(t){e.status=t},expression:"status"}},e._l(e.statusList,(function(t){return s("Option",{key:t.value,attrs:{value:t.value}},[e._v(e._s(t.label))])})),1),s("Input",{staticClass:"m-r-20 width-120",attrs:{type:"text",clearable:"",placeholder:e.tFn("announcementSubject")},model:{value:e.title,callback:function(t){e.title="string"==typeof t?t.trim():t},expression:"title"}}),s("Button",{staticClass:"m-r-20",attrs:{type:"primary",icon:"md-search"},on:{click:e.query}},[e._v(e._s(e._f("lang")("search")))]),s("Button",{staticClass:"m-r-20",attrs:{type:"primary"},on:{click:e.clear}},[e._v(e._s(e._f("lang")("clearSearch")))]),e.pageauthoritys.add?s("Button",{attrs:{type:"primary",icon:"md-add"},on:{click:e.add}},[e._v(e._s(e.tFn("addNewAnnouncement")))]):e._e(),s("m-table",{staticClass:"m-t-20",attrs:{columns:e.columns,data:e.dataList},scopedSlots:e._u([{key:"status",fn:function(t){var n=t.row;return t.index,[s("div",{staticClass:"td-cell"},[e._v(" "+e._s(e.showStatus(n.status))+" ")])]}},{key:"loginPop",fn:function(t){var n=t.row;return t.index,[s("div",{staticClass:"td-cell"},[e._v(" "+e._s(e.showPop(n.loginPop))+" ")])]}},{key:"action",fn:function(t){var n=t.row;return t.index,[3!=n.status&&e.pageauthoritys.status?s("Button",{staticClass:"m-r-20",attrs:{size:"small"},on:{click:function(t){return e.handleStatus(n)}}},[e._v(e._s(n.enabled?e.$t("disabled"):e.$t("enabled")))]):e._e(),e.pageauthoritys.edit?s("Button",{staticClass:"m-r-20",attrs:{size:"small"},on:{click:function(t){return e.handleEdit(n)}}},[e._v(e._s(e._f("lang")("edit")))]):e._e(),e.pageauthoritys.delete?s("Button",{staticClass:"m-r-20",attrs:{size:"small",type:"warning"},on:{click:function(t){return e.handleDel(n)}}},[e._v(e._s(e._f("lang")("delete")))]):e._e()]}}])}),s("m-page",{ref:"pageRef",attrs:{total:e.totalElements,pageSize:e.size,pageSizeOpts:[20,30,50,100,500]},on:{"on-change":e.query,"on-page-size-change":e.pageSizeChange},model:{value:e.page,callback:function(t){e.page=t},expression:"page"}}),s("addNotice",{attrs:{item:e.editItem,type:e.editType},on:{onSuccess:e.query},model:{value:e.showAddNotice,callback:function(t){e.showAddNotice=t},expression:"showAddNotice"}})],1)}),[],!1,null,null,null);t.default=d.exports},feed:function(e,t,s){"use strict";s("5ac6")}}]);