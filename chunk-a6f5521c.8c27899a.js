(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-a6f5521c"],{"1c76":function(e,t,a){"use strict";a.r(t);var n={name:"orderManage",data:function(){return{dateoptions:{disabledDate:function(e){var t=new Date(e),a=new Date;return t>a||t<a-864e6}},loading:!1,fm:{username:"",status:"all",orderNo:"",page:1,size:20,desc:"createTime",totalGoodsAmountMin:null,totalGoodsAmountMax:null,commissionMin:null,commissionMax:null,orderType:"all"},dateRangeValue:[new Date,new Date],totalElements:0,showAddNotice:!1,statusDic:{1:this.$t("orderManege.progress"),2:this.$t("orderManege.completed"),3:this.$t("orderManege.cancelled")},statusList:[{value:"all",label:this.$t("orderManege.all")},{value:"1",label:this.$t("orderManege.progress")},{value:"2",label:this.$t("orderManege.completed")},{value:"3",label:this.$t("orderManege.cancelled")}],typelist:[{value:"all",label:this.$t("orderManege.all")},{value:"1",label:this.$t("orderManege.conventional")},{value:"2",label:this.$t("orderManege.boomingOrder")}],columns:[{type:"selection",width:60,align:"center"},{title:this.$t("orderManege.username"),slot:"username"},{title:this.$t("orderManege.orderType"),key:"formatOrderType"},{title:this.$t("orderManege.orderNumber"),key:"orderNo"},{title:this.$t("orderManege.orderAmount"),key:"totalGoodsAmount",render:function(e,t){return e("span",(+t.row.totalGoodsAmount/100).toFixed(2))}},{title:this.$t("orderManege.quantity"),key:"goodsNumber"},{title:this.$t("orderManege.commissionRate"),key:"commissionRate",render:function(e,t){return e("span",function(e){return(Math.round(1e3*e)/1e3).toString()}((+t.row.commissionRate/1e3).toFixed(4))+"%")}},{title:this.$t("orderManege.commission"),key:"commission",render:function(e,t){return e("span",(+t.row.commission/100).toFixed(2))}},{title:this.$t("orderManege.productName"),key:"goodsTitle",render:function(e,t){return e("div",[e("span",{style:{display:"inline-block",width:"100%",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},domProps:{title:t.row.goodsTitle}},t.row.goodsTitle)])}},{title:this.$t("orderManege.productPicture"),slot:"goodsImage"},{title:this.$t("orderManege.status"),slot:"status"},{title:this.$t("orderManege.creationTime"),key:"createTime"},{title:this.$t("orderManege.completeTime"),key:"completeTime"},{title:this.$t("orderManege.operate"),key:"operation",slot:"action"}],dataList:[],tabList:[]}},components:{Nav:(a("d3b7"),a("25f0"),a("b680"),a("d81d"),a("b0c0"),a("7db0"),a("a9e3"),a("159b"),a("b64b"),a("caad"),a("3d01")).a},mounted:function(){this.tabs=this.getChildRoutes("/orderManage/index").map((function(e){return{path:e.frontPath,name:e.name}}))},methods:{formatOrderType:function(e){return(this.typelist.find((function(t){return Number(t.value)===Number(e)}))||{}).label},del:function(){this.fm={username:"",status:"all",orderNo:"",totalGoodsAmountMin:null,totalGoodsAmountMax:null,commissionMin:null,commissionMax:null,page:1,size:20,orderType:"all"},this.dateRangeValue=[new Date,new Date]},showStatus:function(e){return this.statusDic[e]},selectHandle:function(e){this.tabList=e},refresh:function(){location.reload()},query:function(e){var t=this;1==e&&(this.fm.page=1);var a={};if(Object.keys(this.fm).forEach((function(e){a[e]="all"===t.fm[e]?"":t.fm[e]})),this.dateRangeValue[0]&&(a.beginTime=this.$utils.formatDate(this.dateRangeValue[0],"YYYY-MM-DD")+" 00:00:00"),this.dateRangeValue[1]&&(a.endTime=this.$utils.formatDate(this.dateRangeValue[1],"YYYY-MM-DD")+" 23:59:59"),a.totalGoodsAmountMin&&(a.totalGoodsAmountMin=(100*a.totalGoodsAmountMin).toFixed(0)),a.totalGoodsAmountMax&&(a.totalGoodsAmountMax=(100*a.totalGoodsAmountMax).toFixed(0)),a.commissionMin&&(a.commissionMin=(100*a.commissionMin).toFixed(0)),a.commissionMax&&(a.commissionMax=(100*a.commissionMax).toFixed(0)),!a.username)return this.$Message.error(this.$t("inputUserNameTip"));this.loading=!0,this.$get("/trade/order/tob/page",a).then((function(e){t.dataList=e.content.map((function(e){return Object.assign(e,{goodsImage:t.$formatImageUrl(e.goodsImage),formatOrderType:t.formatOrderType(e.orderType)})})),t.totalElements=Number(e.totalElements)})).catch((function(e){t.$Message.error(e.message)})).finally((function(){t.loading=!1}))},handleRevert:function(e){var t=this;if(1==e.status){var a=[{orderId:e.id,userId:e.userId}];return new Promise((function(){t.$Modal.confirm({title:t.$t("orderManege.errMsg2"),content:t.$t("orderManege.errMsg3"),onOk:function(){t.$post("/trade/order/tob/batchCancelOrder",JSON.stringify(a),{"Content-type":"application/json"}).then((function(){t.$Message.success(t.$t("operateSuccess")),t.query()})).catch((function(e){t.$Message.error(e.message)})).finally((function(){t.loading=!1}))}})}))}this.$Message.info(this.$t("orderManege.errMsg1"))},muilteOp:function(){var e=this;if(this.tabList.length){var t=[],a=[];if(this.tabList.map((function(e){t.push({orderId:e.id,userId:e.userId}),a.push(e.status)})),!a.includes(2))return new Promise((function(){e.$Modal.confirm({title:e.$t("orderManege.errMsg6"),content:e.$t("orderManege.errMsg7"),onOk:function(){e.loading=!0,e.$post("/trade/order/tob/batchCancelOrder",JSON.stringify(t),{"Content-type":"application/json"}).then((function(){e.$Message.success(e.$t("operateSuccess")),e.query()})).catch((function(t){e.$Message.error(t.message)})).finally((function(){e.loading=!1}))}})}));this.$Message.info(this.$t("orderManege.errMsg6"))}else this.$Message.info(this.$t("orderManege.errMsg4"))},pageSizeChange:function(e){this.fm.size=e,this.fm.page=1,this.query()},exportExcel:function(e){var t=this,a={};"all"==e?Object.assign(a,this.fm,{exportType:1}):Object.assign(a,this.fm,{exportType:2}),["status","orderType"].forEach((function(e){"all"===a[e]&&(a[e]="")})),this.$download("/trade/order/tob/exportOrder",a).then((function(){})).catch((function(e){t.$Message.error(e.message)})).finally((function(){t.loading=!1}))}}},o=n,s=(a("6a0e"),a("2877")),r=Object(s.a)(o,(function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"orderManage"},[a("Nav",{attrs:{nav:[{path:"/orderManage/index",name:e.nowpagetitle}]}}),a("div",{staticClass:"innerWrap"},[e._v(" "+e._s(e._f("lang")("orderManege.status"))+" "),a("Select",{staticClass:"m-r-10 width-120",model:{value:e.fm.status,callback:function(t){e.$set(e.fm,"status",t)},expression:"fm.status"}},e._l(e.statusList,(function(t){return a("Option",{key:t.value,attrs:{value:t.value}},[e._v(e._s(t.label))])})),1),e._v(" "+e._s(e._f("lang")("orderManege.orderType"))+" "),a("Select",{staticClass:"m-r-10 width-120",model:{value:e.fm.orderType,callback:function(t){e.$set(e.fm,"orderType",t)},expression:"fm.orderType"}},e._l(e.typelist,(function(t){return a("Option",{key:t.value,attrs:{value:t.value}},[e._v(e._s(t.label))])})),1),e._v(" "+e._s(e._f("lang")("orderManege.account"))),a("Input",{staticClass:"m-r-10 width-120",attrs:{type:"text",clearable:"",placeholder:e.$t("orderManege.account")},model:{value:e.fm.username,callback:function(t){e.$set(e.fm,"username","string"==typeof t?t.trim():t)},expression:"fm.username"}}),e._v(" "+e._s(e._f("lang")("orderManege.orderNumber"))+" "),a("Input",{staticClass:"m-r-10 width-120",attrs:{type:"text",clearable:"",placeholder:e.$t("orderManege.fuzzyQuery")},model:{value:e.fm.orderNo,callback:function(t){e.$set(e.fm,"orderNo","string"==typeof t?t.trim():t)},expression:"fm.orderNo"}}),e._v(" "+e._s(e._f("lang")("orderManege.orderAmount"))),a("InputNumber",{staticClass:"width-120",attrs:{max:999999999},model:{value:e.fm.totalGoodsAmountMin,callback:function(t){e.$set(e.fm,"totalGoodsAmountMin","string"==typeof t?t.trim():t)},expression:"fm.totalGoodsAmountMin"}}),e._v("~"),a("InputNumber",{staticClass:"m-r-10 width-120",attrs:{max:999999999},model:{value:e.fm.totalGoodsAmountMax,callback:function(t){e.$set(e.fm,"totalGoodsAmountMax","string"==typeof t?t.trim():t)},expression:"fm.totalGoodsAmountMax"}}),e._v(" "+e._s(e._f("lang")("orderManege.commission"))),a("InputNumber",{staticClass:"width-120",attrs:{max:999999999},model:{value:e.fm.commissionMin,callback:function(t){e.$set(e.fm,"commissionMin","string"==typeof t?t.trim():t)},expression:"fm.commissionMin"}}),e._v("~"),a("InputNumber",{staticClass:"m-r-10 width-120",attrs:{max:999999999},model:{value:e.fm.commissionMax,callback:function(t){e.$set(e.fm,"commissionMax","string"==typeof t?t.trim():t)},expression:"fm.commissionMax"}}),e._v(" "+e._s(e._f("lang")("orderManege.completeTime"))+" "),a("DatePicker",{staticStyle:{width:"220px","margin-right":"10px"},attrs:{clearable:!1,options:e.dateoptions,type:"daterange"},model:{value:e.dateRangeValue,callback:function(t){e.dateRangeValue=t},expression:"dateRangeValue"}}),a("Button",{staticClass:"m-r-20",attrs:{type:"primary",icon:"md-search"},on:{click:function(t){return e.query(1)}}},[e._v(e._s(e._f("lang")("orderManege.query")))]),a("p",{staticClass:"m-t-10"}),a("Button",{staticClass:"m-r-20",attrs:{type:"primary"},on:{click:e.del}},[e._v(e._s(e._f("lang")("orderManege.clear")))]),a("Button",{staticClass:"m-r-10",attrs:{type:"primary"},on:{click:e.refresh}},[e._v(e._s(e._f("lang")("orderManege.refresh")))]),a("Button",{staticClass:"m-r-10",attrs:{type:"primary"},on:{click:e.muilteOp}},[e._v(e._s(e._f("lang")("orderManege.revoke")))]),a("Table",{ref:"selection",staticClass:"m-t-20",attrs:{columns:e.columns,data:e.dataList},on:{"on-selection-change":e.selectHandle},scopedSlots:e._u([{key:"username",fn:function(t){var n=t.row;return[e._v(" "+e._s(n.username)+" "),2==n.userType?a("span",{staticStyle:{color:"red"}},[e._v("["+e._s(e._f("lang")("orderManege.test"))+"]")]):e._e()]}},{key:"goodsImage",fn:function(e){var t=e.row;return[a("img",{staticClass:"goodsImage_img",attrs:{src:t.goodsImage}})]}},{key:"status",fn:function(t){var a=t.row;return[e._v(" "+e._s(e.showStatus(a.status))+" ")]}},{key:"action",fn:function(t){var n=t.row;return[a("div",{staticClass:"td-cell"},[1==n.status?a("Button",{attrs:{type:"warning"},on:{click:function(t){return e.handleRevert(n)}}},[e._v(e._s(e._f("lang")("orderManege.revoke")))]):e._e()],1)]}}])}),e.loading?a("Spin",{attrs:{size:"large",fix:""}}):e._e(),a("m-page",{attrs:{total:e.totalElements,pageSize:e.fm.size,pageSizeOpts:[20,30,50,100,500]},on:{"on-change":e.query,"on-page-size-change":e.pageSizeChange},model:{value:e.fm.page,callback:function(t){e.$set(e.fm,"page",t)},expression:"fm.page"}})],1)],1)}),[],!1,null,null,null);t.default=r.exports},"6a0e":function(e,t,a){"use strict";a("c06c")},c06c:function(e,t,a){}}]);