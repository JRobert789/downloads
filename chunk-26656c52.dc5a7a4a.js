(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-26656c52"],{a6c7:function(t,e,a){"use strict";a.r(e);var s=(a("d3b7"),function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"lotdetail"},[t.loading?a("Spin",{attrs:{fix:""}}):t._e(),a("Modal",{attrs:{title:t.detailinfo&&t.detailinfo.name?"编辑爬虫":"新增爬虫",width:"800"},model:{value:t.show,callback:function(e){t.show=e},expression:"show"}},[a("Form",{attrs:{"label-width":100}},[a("FormItem",{attrs:{label:"规则名称："}},[a("Input",{attrs:{type:"text"},model:{value:t.form.name,callback:function(e){t.$set(t.form,"name",e)},expression:"form.name"}})],1),a("FormItem",{attrs:{label:"规则内容："}},[a("Input",{attrs:{type:"textarea",rows:10},model:{value:t.form.content,callback:function(e){t.$set(t.form,"content",e)},expression:"form.content"}})],1),a("FormItem",{attrs:{label:"备注："}},[a("Input",{attrs:{type:"text"},model:{value:t.form.remark,callback:function(e){t.$set(t.form,"remark",e)},expression:"form.remark"}})],1),a("FormItem",{attrs:{label:"状态："}},[a("RadioGroup",{model:{value:t.form.status,callback:function(e){t.$set(t.form,"status",e)},expression:"form.status"}},[a("Radio",{attrs:{label:"1"}},[a("span",[t._v("启用")])]),a("Radio",{attrs:{label:"0"}},[a("span",[t._v("禁用")])])],1)],1),a("div",{staticStyle:{color:"red"}},[a("p",[t._v("注：")]),a("p",[t._v("1.方法名称固定为crawl, 返回值为爬取到的商品列表")]),a("p",[t._v(t._s("2.方法参数类型固定为Map＜String, String＞params 内含 minPrice,maxPrice,page,keyword,lang五个数据"))]),a("p",[t._v("3.语法为groovy, 兼容java")])])],1),a("div",{attrs:{slot:"footer"},slot:"footer"},[a("Button",{staticStyle:{"margin-left":"8px"},attrs:{type:"text"},on:{click:t.cancel}},[t._v("取消")]),a("Button",{attrs:{type:"primary"},on:{click:function(e){return t.save()}}},[t._v("确定")])],1)],1)],1)}),o=(a("b0c0"),{name:"spiderMes",props:{value:{default:!1},detailinfo:{default:function(){},type:Object}},data:function(){return{show:!1,loading:!1,form:{name:"",content:"",remark:"",status:"0"}}},methods:{cleanForm:function(){this.form={name:"",content:"",remark:"",status:"1"}},save:function(){var t=this;if(""!==this.form.name&&""!==this.form.content){this.loading=!0;var e;e=this.form.id?"/trade/spider/tob/update":"/trade/spider/tob/add",this.$post(e,this.form).then((function(){t.$Message.success("成功"),t.cleanForm(),t.$emit("clearDate",!0),t.$emit("input",!1)})).catch((function(e){t.$Message.error(e.message)})).finally((function(){t.loading=!1}))}else this.$Message.error("请输入规则名称或者规则内容")},cancel:function(){this.cleanForm(),this.$emit("clearDate",!1),this.$emit("input",!1)}},watch:{value:function(){this.value?(this.show=!0,this.detailinfo.name&&(this.form=this.detailinfo,this.form.status=this.detailinfo.status+"")):this.show=!1},show:function(){this.show||(this.$emit("input",!1),this.cleanForm())}}}),i=o,n=a("2877"),r=Object(n.a)(i,s,[],!1,null,null,null).exports,l={name:"spiderMes",props:{value:{default:!1},showRuleId:{default:"",type:String}},data:function(){return{show:!1,loading:!1,form:{keyword:"",maxPrice:1,minPrice:1,times:1,lang:"zh_CN"}}},methods:{cleanForm:function(){this.form={keyword:"",maxPrice:1,minPrice:100,times:1,lang:""}},save:function(){var t=this;""!==this.form.keyword?(this.form.spiderId=this.showRuleId,this.$post("/trade/spider/tob/execute",this.form).then((function(e){t.$emit("input",!1),t.cleanForm(),t.$Message.success("测试成功")})).catch((function(e){t.$Message.error(e.message)}))):this.$Message.error("请输入关键字")},cancel:function(){this.$emit("input",!1),this.cleanForm()}},watch:{value:function(){this.value?this.show=!0:this.show=!1},show:function(){this.show||this.$emit("input",!1)}}},c=l,u=Object(n.a)(c,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"lotdetail"},[t.loading?a("Spin",{attrs:{fix:""}}):t._e(),a("Modal",{attrs:{title:"测试规则",width:"600"},model:{value:t.show,callback:function(e){t.show=e},expression:"show"}},[a("Form",{attrs:{"label-width":200}},[a("FormItem",{attrs:{label:"商品关键字："}},[a("Input",{attrs:{type:"text"},model:{value:t.form.keyword,callback:function(e){t.$set(t.form,"keyword",e)},expression:"form.keyword"}})],1),a("FormItem",{attrs:{label:"返回语言"}},[a("Select",{staticStyle:{width:"300px"},model:{value:t.form.lang,callback:function(e){t.$set(t.form,"lang",e)},expression:"form.lang"}},[a("Option",{attrs:{value:"zh_CN"}},[t._v("中文")]),a("Option",{attrs:{value:"en_US"}},[t._v("英文")])],1)],1),a("FormItem",{attrs:{label:"爬取商品最大价格(分)"}},[a("InputNumber",{attrs:{min:1},model:{value:t.form.maxPrice,callback:function(e){t.$set(t.form,"maxPrice",e)},expression:"form.maxPrice"}})],1),a("FormItem",{attrs:{label:"爬取商品最小价格(分)"}},[a("InputNumber",{attrs:{min:1},model:{value:t.form.minPrice,callback:function(e){t.$set(t.form,"minPrice",e)},expression:"form.minPrice"}})],1),a("FormItem",{attrs:{label:"最大爬取次数"}},[a("InputNumber",{attrs:{min:1},model:{value:t.form.times,callback:function(e){t.$set(t.form,"times",e)},expression:"form.times"}})],1)],1),a("div",{attrs:{slot:"footer"},slot:"footer"},[a("Button",{staticStyle:{"margin-left":"8px"},attrs:{type:"text"},on:{click:t.cancel}},[t._v("取消")]),a("Button",{attrs:{type:"primary"},on:{click:function(e){return t.save()}}},[t._v("确定")])],1)],1)],1)}),[],!1,null,null,null),m={name:"spider",components:{spiderMes:r,showRule:u.exports},data:function(){return{status:"All",columns:[{title:"规则名称",key:"name",sortable:"custom"},{title:"备注",key:"remark",sortable:"custom"},{title:"状态",slot:"statusType",sortable:"custom"},{title:"最后更新时间",key:"updateTime",sortable:"custom"},{title:"最后更新人",key:"updateBy",sortable:"custom"},{title:"操作",slot:"handle"}],dataList:[],chooseList:[{key:"All",name:"全部"},{key:"1",name:"启用"},{key:"0",name:"禁用"}],totalElements:0,pageNum:1,pageSize:10,loading:!1,spiderName:"",showModel:!1,detailinfo:{},showRuleId:"",showRule:!1}},methods:{sortOrder:function(t){var e=this;this.loading=!0,this.$get("/trade/spider/tob/page",{page:this.pageNum,size:this.pageSize,status:"All"===this.status?"":this.status,name:this.spiderName,orderField:t.key.toUpperCase(),orderDirection:t.order}).then((function(t){e.dataList=t.content,e.totalElements=+t.totalElements})).catch((function(t){e.$Message.error(t.message)})).finally((function(){e.loading=!1}))},deleteSpider:function(t){var e=this;this.loading=!0,this.$post("/trade/spider/tob/delete",{id:t}).then((function(){e.$Message.success("删除成功"),e.getExportReport()})).catch((function(t){e.$Message.error(t.message)})).finally((function(){e.loading=!1}))},getExportReport:function(){var t=this;this.loading=!0,this.$get("/trade/spider/tob/page",{page:this.pageNum,size:this.pageSize,status:"All"===this.status?"":this.status,name:this.spiderName}).then((function(e){t.dataList=e.content,t.totalElements=+e.totalElements})).catch((function(e){t.$Message.error(e.message)})).finally((function(){t.loading=!1}))},pageSizeChange:function(t){this.pageSize=t,this.getExportReport()},clearDate:function(t){this.detailinfo={},t&&this.getExportReport()}},mounted:function(){this.getExportReport()}},d=m,p=(a("ceb6"),Object(n.a)(d,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"spiderWarp"},[t.loading?a("Spin",{attrs:{fix:""}}):t._e(),a("div",{staticClass:"spider"},[a("Form",{attrs:{inline:""}},[a("FormItem",{attrs:{label:"规则名称:","label-width":80}},[a("Input",{attrs:{type:"text",placeholder:"规则名称"},model:{value:t.spiderName,callback:function(e){t.spiderName=e},expression:"spiderName"}})],1),a("FormItem",{attrs:{label:"状态:","label-width":80}},[a("Select",{staticStyle:{width:"140px"},model:{value:t.status,callback:function(e){t.status=e},expression:"status"}},t._l(t.chooseList,(function(e){return a("Option",{key:e.key,attrs:{value:e.key}},[t._v(t._s(e.name))])})),1)],1),a("FormItem",[a("Button",{attrs:{type:"primary"},on:{click:function(e){t.pageNum=1,t.getExportReport()}}},[t._v("查询")]),a("Button",{staticStyle:{"margin-left":"20px"},attrs:{type:"primary"},on:{click:function(e){t.showModel=!0}}},[t._v("新增")])],1)],1),a("Table",{attrs:{columns:t.columns,data:t.dataList,size:"small"},on:{"on-sort-change":t.sortOrder},scopedSlots:t._u([{key:"statusType",fn:function(e){var a=e.row;return[t._v(" "+t._s(1==+a.status?"启用":"禁用")+" ")]}},{key:"handle",fn:function(e){var s=e.row;return[a("div",{staticClass:"buttonList"},[a("span",{on:{click:function(e){t.showRule=!0,t.showRuleId=s.id}}},[t._v("测试规则")]),a("span",{on:{click:function(e){t.detailinfo=s,t.showModel=!0}}},[t._v("编辑")]),a("span",{on:{click:function(e){return t.deleteSpider(s.id)}}},[t._v("删除")])])]}}])}),a("m-page",{attrs:{total:t.totalElements,pageSize:t.pageSize},on:{"on-change":t.getExportReport,"on-page-size-change":t.pageSizeChange},model:{value:t.pageNum,callback:function(e){t.pageNum=e},expression:"pageNum"}})],1),a("spiderMes",{attrs:{detailinfo:t.detailinfo},on:{clearDate:t.clearDate},model:{value:t.showModel,callback:function(e){t.showModel=e},expression:"showModel"}}),a("showRule",{attrs:{showRuleId:t.showRuleId},on:{clearDate:t.clearDate},model:{value:t.showRule,callback:function(e){t.showRule=e},expression:"showRule"}})],1)}),[],!1,null,null,null));e.default=p.exports},ceb6:function(t,e,a){"use strict";a("e4ca")},e4ca:function(t,e,a){}}]);