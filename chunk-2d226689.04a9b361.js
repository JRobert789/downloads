(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-2d226689"],{e910:function(t,e,i){"use strict";i.r(e);var n=i("1da1"),a=i("ade3"),o=i("5530"),r=(i("96cf"),i("d3b7"),i("4de4"),i("b0c0"),i("d81d"),i("a9e3"),{name:"rouletteTarget",data:function(){return{userName:"",commodityId:"",page:1,size:10,totalElements:0,loading:!1,dataList:[],columns:[{title:this.$t("event.createTime"),key:"createTime"},{title:this.tFn("username"),key:"userName"},{title:this.tFn("cname"),slot:"commodityName"},{title:this.tFn("cid"),key:"commodityId"},{title:this.tFn("camount"),slot:"formatAmount"},{title:this.tFn("createTime"),key:"createTime"},{title:this.tFn("updateTime"),key:"updateTime"},{title:this.$t("operation"),slot:"operation"}],add:!1,targetUserName:"",setting:!1,targetCommodityId:"",commodityList:[],dateOption:{disabledDate:function(t){var e=new Date(t),i=new Date;return e>i||e<i-7776e6}}}},computed:{targetDisabled:function(){return!(this.targetUserName&&this.targetCommodityId)},commodityIdMap:function(){return this.commodityList.reduce((function(t,e){return Object(o.a)(Object(o.a)({},t),{},Object(a.a)({},e.id,e))}),{})}},methods:{deleteHandler:function(t){var e=this;this.loading=!0;var i=t.id;this.$post("/activity/roulette/tob/removeTargetFixedCommodity",{id:i}).then((function(){e.dataList=e.dataList.filter((function(t){return t.id!==i}))})).catch((function(t){e.$Message.error(t.message)})).finally((function(){e.loading=!1}))},getCommodityMoney:function(t){if(t){var e=this.commodityIdMap[t]||{};return this.$utils.toYuan(e.money)}return""},getCommodityName:function(t){return t?(this.commodityIdMap[t]||{}).name:""},showAdd:function(){this.add=!0},getCommodityList:function(){var t=this;return this.setting=!0,this.$get("/activity/roulette/tob/getCommodityList").then((function(e){t.commodityList=e||[]})).catch((function(e){t.$Message.error(e.message)})).finally((function(){t.setting=!1}))},closeHandler:function(){this.targetUserName="",this.add=!1,this.targetCommodityId=""},addHandler:function(){var t=this;return Object(n.a)(regeneratorRuntime.mark((function e(){var i;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.setting){e.next=2;break}return e.abrupt("return");case 2:return t.setting=!0,e.prev=3,i=t.targetUserName,e.next=7,t.submitHandler(i,t.targetCommodityId);case 7:t.closeHandler(),t.getConfigList(1),e.next=14;break;case 11:e.prev=11,e.t0=e.catch(3),t.$Message.error(e.t0.message);case 14:return e.prev=14,t.setting=!1,e.finish(14);case 17:case"end":return e.stop()}}),e,null,[[3,11,14,17]])})))()},submitHandler:function(t,e){return this.$post("/activity/roulette/tob/setTargetFixedCommodity",{userName:t,commodityId:e})},pageSizeChange:function(t){this.size=t,this.getConfigList(1)},tFn:function(t,e){return this.$t("roulette.".concat(t),e)},getConfigList:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;this.loading=!0,this.$get("/activity/roulette/tob/getTargetFixedPage",{userName:this.userName,commodityId:this.commodityId,page:this.page=e,size:this.size}).then((function(e){var i=e||{content:[]},n=i.content,a=i.totalElements;t.dataList=n.map((function(t){return Object(o.a)({},t)})),t.totalElements=Number(a)||0})).catch((function(e){t.dataList=[],t.totalElements=0,t.$Message.error(e.message)})).finally((function(){t.loading=!1}))}},mounted:function(){this.getConfigList(1),this.getCommodityList()}}),s=r,m=i("2877"),d=Object(m.a)(s,(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"roulette_target"},[t.loading?i("Spin",{attrs:{fix:""}}):t._e(),i("Form",{attrs:{inline:""}},[i("FormItem",[t._v(" "+t._s(t.tFn("username"))+" "),i("Input",{staticStyle:{width:"140px"},attrs:{type:"text",maxlength:"30"},model:{value:t.userName,callback:function(e){t.userName=e},expression:"userName"}})],1),i("FormItem",[t._v(" "+t._s(t.tFn("cid"))+" "),i("Input",{staticStyle:{width:"140px"},attrs:{type:"text"},model:{value:t.commodityId,callback:function(e){t.commodityId=e},expression:"commodityId"}})],1),i("FormItem",[i("Button",{attrs:{type:"primary",icon:"md-search"},on:{click:function(e){return t.getConfigList(1)}}},[t._v(t._s(t._f("lang")("search")))])],1),t.pageauthoritys.add?i("FormItem",[i("Button",{attrs:{type:"primary"},on:{click:t.showAdd}},[t._v(t._s(t._f("lang")("add")))])],1):t._e()],1),i("m-table",{attrs:{size:"small",columns:t.columns,data:t.dataList},scopedSlots:t._u([{key:"commodityName",fn:function(e){var n=e.row;return[i("span",[t._v(" "+t._s(t.getCommodityName(n.commodityId))+" ")])]}},{key:"formatAmount",fn:function(e){var n=e.row;return[i("span",[t._v(" "+t._s(t.getCommodityMoney(n.commodityId))+" ")])]}},{key:"operation",fn:function(e){var n=e.row;return[t.pageauthoritys.delete?i("Tooltip",{attrs:{confirm:"",content:t.$t("delete"),placement:"top"}},[i("Poptip",{attrs:{confirm:"",title:t.$t("event.confirmText1")},on:{"on-ok":function(e){return t.deleteHandler(n)}}},[i("Button",{attrs:{size:"small",icon:"md-trash"}})],1)],1):t._e()]}}])}),i("m-page",{attrs:{total:t.totalElements,pageSize:t.size},on:{"on-change":function(e){return t.getConfigList(1)},"on-page-size-change":t.pageSizeChange},model:{value:t.page,callback:function(e){t.page=e},expression:"page"}}),i("Modal",{attrs:{width:"400",title:t.tFn("targetedProductSettings")},model:{value:t.add,callback:function(e){t.add=e},expression:"add"}},[t.setting?i("Spin",{attrs:{fix:""}}):t._e(),i("Form",{attrs:{"label-width":100}},[i("FormItem",{attrs:{label:t.tFn("username")}},[i("Input",{staticStyle:{width:"200px"},model:{value:t.targetUserName,callback:function(e){t.targetUserName=e},expression:"targetUserName"}})],1),i("FormItem",{attrs:{label:t.tFn("cname")}},[i("Select",{staticStyle:{width:"200px"},model:{value:t.targetCommodityId,callback:function(e){t.targetCommodityId=e},expression:"targetCommodityId"}},t._l(t.commodityList,(function(e){return i("Option",{key:e.id,attrs:{value:e.id}},[t._v(" "+t._s(e.name)+" ")])})),1)],1)],1),i("div",{attrs:{slot:"footer"},slot:"footer"},[i("Button",{on:{click:t.closeHandler}},[t._v(t._s(t.$t("cancel")))]),i("Button",{attrs:{type:"primary",loading:t.setting,disabled:t.targetDisabled},on:{click:t.addHandler}},[t._v(t._s(t.$t("confirm")))])],1)],1)],1)}),[],!1,null,"a330f01e",null);e.default=d.exports}}]);