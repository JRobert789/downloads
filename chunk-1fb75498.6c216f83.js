(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-1fb75498"],{"34c7":function(e,t,r){},"6a03":function(e,t,r){"use strict";r("a1ca")},a1ca:function(e,t,r){},a5f2:function(e,t,r){"use strict";r("f72c")},ba70:function(e,t,r){"use strict";r.r(t);var a=(r("d3b7"),function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("Modal",{attrs:{title:e.$t("userRank.privilege")},model:{value:e.value2,callback:function(t){e.value2=t},expression:"value2"}},[r("table",{staticClass:"user-rank-info-table cmtable"},e._l(e.detail.rankProxyDTOs,(function(t,a){return r("tr",{key:a},[r("td",[e._v(e._s(e._f("lang")("userRank.LevelAgent",{num:t.proxyLevel})))]),r("td",[e._v(e._s(t.proxyNum))]),0===a?[r("td",[e._v(e._s(e.$t("userRank.Alldeposit")))]),r("td",[e._v(e._s(t.proxyMoney/100))])]:[r("td"),r("td")]],2)})),0),r("div",{attrs:{slot:"footer"},slot:"footer"})])}),n={props:{value:{default:!1,type:Boolean},detail:{default:function(){},type:Object}},computed:{value2:{get:function(){return this.value},set:function(e){this.$emit("input",e)}}}},s=n,o=(r("a5f2"),r("2877")),i=Object(o.a)(s,a,[],!1,null,null,null).exports,l=(r("159b"),r("b680"),{props:{value:{default:!1,type:Boolean},detail:{default:null,type:Object}},data:function(){return{form:{rankName:"",rankScore:0,scoreRatio:0,remark:"",bonusType:0,rankLevel:1},rule:{rankName:[{required:!0,message:this.$t("userRank.rankNameerrorTips"),trigger:"blur",pattern:/[0-9a-zA-Z.]/}]},showSpin:!1,levelList:[{proxyLevel:1,proxyNum:0,proxyMoney:0}],loading:!1}},methods:{addlevelList:function(){4!==this.levelList.length?this.levelList.push({proxyLevel:this.levelList.length+1,proxyNum:1}):this.$Message.error(this.$t("userRank.levelListerroeTips",{num:4}))},initData:function(){var e=this;if(this.detail){["rankLevel","rankScore","scoreRatio","bonusType"].forEach((function(t){e.form[t]=+e.detail[t]})),this.levelList=this.detail.rankProxyDTOs.length?JSON.parse(JSON.stringify(this.detail.rankProxyDTOs)):[{proxyLevel:1,proxyNum:0,proxyMoney:0}],this.levelList[0].proxyMoney=(+this.levelList[0].proxyMoney||0)/100;var t=this.detail,r=t.rankName,a=t.remark;this.form.rankName=r,this.form.remark=a}},save:function(){var e=this;this.$refs.formDrawer.validate((function(t){if(t){if(!/^[0-9]+([.]{1}[0-9]{1,2})?$/.test(e.form.scoreRatio))return void e.$Message.error(e.$t("userRank.scoreRatioerrorTips"));var r=Object.assign({},e.form);e.detail&&(r.id=e.detail.id),e.levelList.forEach((function(t){t.rankLevel=e.form.rankLevel})),r.rankProxyDTOs=JSON.parse(JSON.stringify(e.levelList)),r.rankProxyDTOs[0].proxyMoney=(100*+r.rankProxyDTOs[0].proxyMoney).toFixed(0),e.showSpin=!0;var a=e.detail?"/user/rank/tob/updateUserRank":"/user/rank/tob/addUserRank";e.$post(a,r,{"Content-type":"application/json;charset=UTF-8"}).then((function(){e.$Message.success(e.$t("operateSuccess")),e.$emit("save")})).catch((function(t){e.$Message.error(t.message)})).finally((function(){e.showSpin=!1}))}}))},query:function(){var e=this;this.loading=!0,this.$get("/user/rank/tob/getUserRankMax").then((function(t){e.form.rankLevel=t+1,e.detail&&e.initData()})).finally((function(){e.loading=!1}))},handleClose:function(){this.$emit("input",!1)}},computed:{title:function(){return this.detail?this.$t("userRank.Edit"):this.$t("proxy.add")},value2:{get:function(){return this.value},set:function(e){this.$emit("input",e)}}},watch:{value:function(){this.levelList=[{proxyLevel:1,proxyNum:0,proxyMoney:0}],this.value?this.query():this.form={rankName:"",rankScore:0,scoreRatio:0,remark:"",bonusType:0,rankLevel:1}}},mounted:function(){this.query()}}),u=l,c=(r("ec0b"),Object(o.a)(u,(function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("Drawer",{staticClass:"userrank_drawer",attrs:{title:e.$t("userRank.Editlevel",{type:e.title}),width:"800"},model:{value:e.value2,callback:function(t){e.value2=t},expression:"value2"}},[e.loading?r("Spin",{attrs:{fix:""}}):e._e(),r("Form",{ref:"formDrawer",attrs:{model:e.form,rules:e.rule,"label-width":150}},[r("FormItem",{attrs:{label:e.$t("menu.userlevel")}},[e._v(" "+e._s(e.form.rankLevel)+e._s(e.$t("userRank.level"))+" ")]),r("FormItem",{attrs:{label:e.$t("userRank.rankName"),prop:"rankName"}},[r("Input",{attrs:{type:"text",maxlength:"8"},model:{value:e.form.rankName,callback:function(t){e.$set(e.form,"rankName",t)},expression:"form.rankName"}}),r("p",[e._v(e._s(e.$t("userRank.rankNameTips")))])],1),r("FormItem",{attrs:{label:e.$t("userRank.Requiredpoints"),prop:"rankScore"}},[r("InputNumber",{attrs:{min:0,max:999999999,disabled:1===e.form.rankLevel},model:{value:e.form.rankScore,callback:function(t){e.$set(e.form,"rankScore",t)},expression:"form.rankScore"}}),r("p",[e._v(e._s(e.$t("userRank.rankScoreTips")))])],1),r("FormItem",{attrs:{label:e.$t("userRank.scoreRatio"),prop:"scoreRatio"}},[r("div",{staticClass:"inputandtext"},[r("InputNumber",{attrs:{min:0,max:99999},model:{value:e.form.scoreRatio,callback:function(t){e.$set(e.form,"scoreRatio",t)},expression:"form.scoreRatio"}}),r("span",[e._v(e._s(e.$t("userRank.Times")))])],1),r("p",[e._v(e._s(e.$t("userRank.scoreRatioTips")))])]),r("FormItem",{attrs:{label:e.$t("userRank.remark"),prop:"remark"}},[r("Input",{staticClass:"textarea",attrs:{type:"text",autosize:{minRows:2,maxRows:5}},model:{value:e.form.remark,callback:function(t){e.$set(e.form,"remark",t)},expression:"form.remark"}})],1),1!==e.form.rankLevel?r("FormItem",{attrs:{label:e.$t("userRank.privilege")}},[r("div",{staticClass:"userrank_drawer_set"},[r("ul",e._l(e.levelList,(function(t,a){return r("li",{key:a},[r("p",[e._v(e._s(e._f("lang")("userRank.LevelAgent",{num:t.proxyLevel}))+":")]),r("InputNumber",{staticStyle:{width:"100px"},attrs:{min:0},model:{value:t.proxyNum,callback:function(r){e.$set(t,"proxyNum",r)},expression:"i.proxyNum"}}),0===a?[r("p",{staticStyle:{color:"#000"}},[e._v(e._s(e.$t("userRank.allMoney"))+":")]),r("InputNumber",{staticStyle:{width:"100px"},attrs:{min:0,max:99999999},model:{value:t.proxyMoney,callback:function(r){e.$set(t,"proxyMoney",r)},expression:"i.proxyMoney"}})]:e._e(),0!==a&&a===e.levelList.length-1?r("Button",{attrs:{type:"primary"},on:{click:function(t){return e.levelList.pop()}}},[r("Icon",{attrs:{type:"md-trash"}})],1):e._e()],2)})),0),r("Button",{attrs:{type:"primary"},on:{click:e.addlevelList}},[e._v(e._s(e.$t("userRank.Add")))])],1)]):e._e(),r("FormItem",[r("Button",{attrs:{type:"primary",loading:e.showSpin},on:{click:function(t){return e.save()}}},[e._v(e._s(e.$t("confirm")))]),r("Button",{staticStyle:{"margin-left":"8px"},on:{click:e.handleClose}},[e._v(e._s(e.$t("cancel")))])],1)],1)],1)}),[],!1,null,null,null)),p={data:function(){return{columns:[{title:this.$t("userRank.rankLevel"),key:"rankLevel"},{title:this.$t("userRank.rankName"),key:"rankName"},{title:this.$t("userRank.rankScore"),key:"rankScore"},{title:this.$t("userRank.privilege"),key:"privilege",slot:"privilege"},{title:this.$t("userRank.option"),key:"option",slot:"option"}],dataList:[],showModal:!1,showDrawer:!1,drawerDetail:null,detail:{userRankScoreList:[],upgradeReward:0,level1Ratio:0,level2Ratio:0,level3Ratio:0},loading:!1}},methods:{add:function(){this.showDrawer=!0,this.drawerDetail=null},query:function(){var e=this;this.$get("/user/rank/tob/getUserRanks").then((function(t){e.dataList=t})).catch((function(t){e.dataList=[],e.$Message.error(t.message)})).finally((function(){e.loading=!1}))},openModal:function(e){this.showModal=!0,this.detail=e},edit:function(e){this.showDrawer=!0,this.drawerDetail=e},save:function(){this.showDrawer=!1,this.query()}},components:{modal:i,drawer:c.exports,Nav:r("3d01").a},mounted:function(){this.query()}},m=p,d=(r("6a03"),Object(o.a)(m,(function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"user-rank-info"},[e.loading?r("Spin",{attrs:{fix:""}}):e._e(),r("Nav",{attrs:{nav:[{path:"/userRank",name:e.nowpagetitle}]}}),r("div",{staticClass:"userRank"},[r("Form",{nativeOn:{submit:function(e){e.preventDefault()}}},[r("FormItem",[e.pageauthoritys.add?r("Button",{attrs:{type:"primary"},on:{click:function(t){return e.add()}}},[e._v(e._s(e.$t("userRank.addlevel")))]):e._e()],1)],1),r("m-table",{attrs:{size:"small",columns:e.columns,data:e.dataList},scopedSlots:e._u([{key:"privilege",fn:function(t){var a=t.row;return[r("a",{on:{click:function(t){return e.openModal(a)}}},[e._v(e._s(e.$t("userRank.examine")))])]}},{key:"option",fn:function(t){var a=t.row;return[e.pageauthoritys.update?r("Tooltip",{attrs:{content:e.$t("userRank.modify"),placement:"top"}},[r("Button",{attrs:{size:"small",icon:"md-create"},on:{click:function(t){return e.edit(a)}}})],1):e._e()]}}])}),r("modal",{attrs:{detail:e.detail},model:{value:e.showModal,callback:function(t){e.showModal=t},expression:"showModal"}}),r("drawer",{attrs:{detail:e.drawerDetail},on:{save:function(t){return e.save()}},model:{value:e.showDrawer,callback:function(t){e.showDrawer=t},expression:"showDrawer"}})],1)],1)}),[],!1,null,null,null));t.default=d.exports},ec0b:function(e,t,r){"use strict";r("34c7")},f72c:function(e,t,r){}}]);