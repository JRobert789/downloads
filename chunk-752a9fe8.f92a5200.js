(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-752a9fe8"],{1765:function(t,e,a){"use strict";a("461f")},"461f":function(t,e,a){},d234:function(t,e,a){"use strict";a.r(e);var o=(a("d3b7"),a("d81d"),{data:function(){return{loading:!1,value2:!1,value3:!1,formValue:{},form:{},pageNum:1,pageSize:20,totalElements:0,pageSizeArray:[20,30,50],columns:[{type:"selection",width:60,align:"center"},{title:"网站线路名称",key:"name"},{title:"网站线路域名",key:"domain"},{title:"电脑端目录",key:"pcRoot"},{title:"手机端目录",key:"phoneRoot"},{title:"跳转域名",key:"rewriteUrl"},{title:"upstream",key:"proxyUrl"},{title:"创建时间",key:"createTime"},{title:"状态",slot:"status"},{title:"操作",key:"operation",slot:"operation",width:220}],dataList:[],tabList:[],rules:{name:[{type:"string",required:!0,message:"请您输入名称",trigger:"blur"}],domain:[{required:!0,pattern:/^(?:http(s)?:\/\/)?[\w.-]+(?:\.[\w\.-]+)+[\w\-\._~:/?#[\]@!\$&'\*\+,;=.]+$/,message:"请输入正确的url"}],rewriteUrl:[{pattern:/^(?:http(s)?:\/\/)?[\w.-]+(?:\.[\w\.-]+)+[\w\-\._~:/?#[\]@!\$&'\*\+,;=.]+$/,message:"请输入正确的url"}],pcRoot:[{type:"string",required:!0,message:"请您输入电脑端目录名称",trigger:"blur"}],phoneRoot:[{type:"string",required:!0,message:"请您输入手机端目录名称",trigger:"blur"}],proxyUrl:[{type:"string",required:!0,message:"请输入upstream"}]},editType:"",file:null}},computed:{},methods:{handleChange:function(t){this.loading=!0,this.pageNum=t,this.query()},pageSizeChange:function(t){this.loading=!0,this.pageSize=t,this.query()},reset:function(){this.formValue={}},download:function(){this.$download("/platform/domain/tob/downloadTemplate")},selectHandle:function(t){this.tabList=t},filechange:function(t){this.file=t.target.files[0]},upload:function(){var t=this;if(this.file){this.loading=!0;var e=new FormData;e.append("file",this.file),this.$post("/platform/domain/tob/templateImport",e,{"Content-type":"multipart/form-data"}).then((function(){t.$Message.success("导入成功"),t.value3=!1,t.file={},t.query()})).catch((function(e){t.$Message.error(e.message)})).finally((function(){t.loading=!1,t.$refs.upload.value="",t.$emit("input",!1)}))}else this.$Message.error("请选择上传文件")},importFile:function(){this.value3=!0},handleAdd:function(){this.$refs.fm.resetFields(),this.value2=!0,this.editType="add",this.form={name:"",domain:"",pcRoot:"",remark:"",phoneRoot:"",rewriteUrl:"",status:0,proxyUrl:""}},handleConfirm:function(){var t=this;"add"==this.editType?this.$refs.fm.validate((function(e){e&&(t.loading=!0,t.$post("/platform/domain/tob/add",t.form).then((function(){t.$Message.success(t.$t("addSucceeded")),t.value2=!1,t.query()})).catch((function(e){t.$Message.error(e.message)})).finally((function(){t.loading=!1})))})):this.$refs.fm.validate((function(e){e&&(t.loading=!0,t.$post("/platform/domain/tob/update",t.form).then((function(){t.$Message.success(t.$t("changeSuccess")),t.value2=!1,t.query()})).catch((function(e){t.$Message.error(e.message)})).finally((function(){t.loading=!1})))}))},handleEdit:function(t){this.editType="edit",this.$refs.fm.resetFields(),this.form=JSON.parse(JSON.stringify(t)),this.value2=!0},handleOp:function(t){var e=this;if(this.tabList.length){var a=[];return this.tabList.map((function(t,e){a.push(t.id)})),new Promise("open"==t?function(t){e.$Modal.confirm({title:"确认启用",content:"您确认启用选中的域名吗？",onOk:function(){e.loading=!0,e.$post("/platform/domain/tob/batchUpdateStatus",{ids:a,status:1},{formatway:"repeat"}).then((function(){e.$Message.success(e.$t("opSuccess"))})).catch((function(t){e.$Message.error(t.message)})).finally((function(){e.query(),e.loading=!1}))}})}:"close"==t?function(t){e.$Modal.confirm({title:"确认禁用",content:"您确认禁用选中的域名吗？",onOk:function(){e.loading=!0,e.$post("/platform/domain/tob/batchUpdateStatus",{ids:a,status:0},{formatway:"repeat"}).then((function(){e.$Message.success(e.$t("opSuccess"))})).catch((function(t){e.$Message.error(t.message)})).finally((function(){e.query(),e.loading=!1}))}})}:function(t){e.$Modal.confirm({title:"确认删除",content:"您确认删除选中的域名吗？",onOk:function(){e.loading=!0,e.$post("/platform/domain/tob/batchDelete",{ids:a},{formatway:"repeat"}).then((function(){e.$Message.success(e.$t("opSuccess"))})).catch((function(t){e.$Message.error(t.message)})).finally((function(){e.query(),e.loading=!1}))}})})}this.$Message.info("请至少选择一条域名")},handleDel:function(t){var e=this;return new Promise((function(a){e.$Modal.confirm({title:"确认删除",content:"您确认删除这条域名吗？",onOk:function(){e.loading=!0,e.$post("/platform/domain/tob/batchDelete",{ids:[t.id]},{formatway:"repeat"}).then((function(){e.$Message.success(e.$t("opSuccess"))})).catch((function(t){e.$Message.error(t.message)})).finally((function(){e.query(),e.loading=!1}))}})}))},handleSwitch:function(t,e){var a=this,o="",n="";return 0==e?(o="确认禁用",n="您确认禁用这条域名吗？"):(o="确认启用",n="您确认启用这条域名吗？"),new Promise((function(s){a.$Modal.confirm({title:o,content:n,onOk:function(){a.loading=!0,a.$post("/platform/domain/tob/batchUpdateStatus",{ids:[t.id],status:e},{formatway:"repeat"}).then((function(){a.$Message.success(a.$t("opSuccess"))})).catch((function(t){a.$Message.error(t.message)})).finally((function(){a.query(),a.loading=!1}))}})}))},query:function(){var t=this,e=Object.assign(this.formValue,{page:this.pageNum,limit:this.pageSize});this.$get("/platform/domain/tob/page",e).then((function(e){t.dataList=e.content,t.totalElements=+e.totalElements})).catch((function(e){t.$Message.error(e.message)})).finally((function(){t.loading=!1}))}},components:{},mounted:function(){this.query()}}),n=o,s=(a("1765"),a("2877")),r=Object(s.a)(n,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"bankTable-configuration"},[t.loading?a("Spin",{attrs:{fix:""}}):t._e(),a("div",{staticClass:"option-menu"},[a("Form",{attrs:{model:t.formValue,inline:""}},[a("FormItem",[a("Select",{attrs:{placeholder:"状态"},model:{value:t.formValue.status,callback:function(e){t.$set(t.formValue,"status",e)},expression:"formValue.status"}},[a("Option",{attrs:{value:""}},[t._v("全部")]),a("Option",{attrs:{value:"1"}},[t._v("启用")]),a("Option",{attrs:{value:"0"}},[t._v("禁用")])],1)],1),a("FormItem",[a("Input",{staticStyle:{width:"240px"},model:{value:t.formValue.name,callback:function(e){t.$set(t.formValue,"name",e)},expression:"formValue.name"}},[a("span",{attrs:{slot:"prepend"},slot:"prepend"},[t._v("网站线路名称")])])],1),a("FormItem",[a("Input",{staticStyle:{width:"240px"},model:{value:t.formValue.domain,callback:function(e){t.$set(t.formValue,"domain",e)},expression:"formValue.domain"}},[a("span",{attrs:{slot:"prepend"},slot:"prepend"},[t._v("网站线路域名")])])],1),a("FormItem",[a("Input",{staticStyle:{width:"240px"},model:{value:t.formValue.rewriteUrl,callback:function(e){t.$set(t.formValue,"rewriteUrl",e)},expression:"formValue.rewriteUrl"}},[a("span",{attrs:{slot:"prepend"},slot:"prepend"},[t._v("手机域名")])])],1),a("FormItem",[a("Input",{staticStyle:{width:"240px"},model:{value:t.formValue.proxyUrl,callback:function(e){t.$set(t.formValue,"proxyUrl",e)},expression:"formValue.proxyUrl"}},[a("span",{attrs:{slot:"prepend"},slot:"prepend"},[t._v("upstream")])])],1),a("Button",{attrs:{type:"primary"},on:{click:t.query}},[t._v("查询")]),a("Button",{staticStyle:{"margin-left":"10px"},attrs:{type:"primary"},on:{click:t.reset}},[t._v("重置")]),a("Button",{staticStyle:{"margin-left":"10px"},attrs:{type:"success"},on:{click:function(e){return t.handleOp("open")}}},[t._v("批量开启")]),a("Button",{staticStyle:{"margin-left":"10px"},attrs:{type:"error"},on:{click:function(e){return t.handleOp("close")}}},[t._v("批量禁用")]),a("Button",{staticStyle:{"margin-left":"10px"},attrs:{type:"error"},on:{click:function(e){return t.handleOp("del")}}},[t._v("批量删除")]),a("Button",{staticStyle:{"margin-left":"10px"},attrs:{icon:"md-add",type:"success"},on:{click:t.importFile}},[t._v("导入")]),a("Button",{staticStyle:{"margin-left":"10px"},attrs:{icon:"md-add",type:"success"},on:{click:t.handleAdd}},[t._v("新增")])],1)],1),a("Table",{attrs:{border:"",columns:t.columns,data:t.dataList},on:{"on-selection-change":t.selectHandle},scopedSlots:t._u([{key:"status",fn:function(e){var a=e.row;return e.index,[t._v(" "+t._s(1==a.status?"启用":"禁用")+" ")]}},{key:"operation",fn:function(e){var o=e.row;return e.index,[a("div",{staticClass:"operation-btn-group"},[a("Button",{attrs:{size:"small"},on:{click:function(e){return t.handleEdit(o)}}},[t._v("编辑")]),a("Button",{staticStyle:{"margin-left":"20px"},attrs:{size:"small",type:"warning"},on:{click:function(e){return t.handleDel(o)}}},[t._v("删除")]),1==o.status?a("Button",{staticStyle:{"margin-left":"20px"},attrs:{size:"small",type:"warning"},on:{click:function(e){return t.handleSwitch(o,0)}}},[t._v("禁用")]):t._e(),0==o.status?a("Button",{staticStyle:{"margin-left":"20px"},attrs:{size:"small",type:"warning"},on:{click:function(e){return t.handleSwitch(o,1)}}},[t._v("启用")]):t._e()],1)]}}])}),a("m-page",{attrs:{total:+t.totalElements,pageSizeOpts:t.pageSizeArray,pageSize:+t.pageSize},on:{"on-change":t.handleChange,"on-page-size-change":t.pageSizeChange},model:{value:t.pageNum,callback:function(e){t.pageNum=e},expression:"pageNum"}}),a("Modal",{attrs:{title:"新增\\编辑"},model:{value:t.value2,callback:function(e){t.value2=e},expression:"value2"}},[a("Form",{ref:"fm",attrs:{model:t.form,rules:t.rules,"label-width":120}},[a("FormItem",{attrs:{label:"网站线路名称",prop:"name"}},[a("Input",{staticStyle:{width:"240px"},model:{value:t.form.name,callback:function(e){t.$set(t.form,"name",e)},expression:"form.name"}})],1),a("FormItem",{attrs:{label:"网站线路域名",prop:"domain"}},[a("Input",{staticStyle:{width:"240px"},model:{value:t.form.domain,callback:function(e){t.$set(t.form,"domain",e)},expression:"form.domain"}})],1),a("FormItem",{attrs:{label:"电脑端目录",prop:"pcRoot"}},[a("Input",{staticStyle:{width:"240px"},model:{value:t.form.pcRoot,callback:function(e){t.$set(t.form,"pcRoot",e)},expression:"form.pcRoot"}})],1),a("FormItem",{attrs:{label:"手机端目录",prop:"phoneRoot"}},[a("Input",{staticStyle:{width:"240px"},model:{value:t.form.phoneRoot,callback:function(e){t.$set(t.form,"phoneRoot",e)},expression:"form.phoneRoot"}})],1),a("FormItem",{attrs:{label:"跳转域名",prop:"rewriteUrl"}},[a("Input",{staticStyle:{width:"240px"},model:{value:t.form.rewriteUrl,callback:function(e){t.$set(t.form,"rewriteUrl",e)},expression:"form.rewriteUrl"}})],1),a("FormItem",{attrs:{label:"状态"}},[a("i-switch",{attrs:{size:"large","true-value":1,"false-value":0},model:{value:t.form.status,callback:function(e){t.$set(t.form,"status",e)},expression:"form.status"}},[a("span",{attrs:{slot:"open"},slot:"open"},[t._v("开启")]),a("span",{attrs:{slot:"close"},slot:"close"},[t._v("关闭")])])],1),a("FormItem",{attrs:{label:"upstream",prop:"proxyUrl"}},[a("Input",{staticStyle:{width:"240px"},model:{value:t.form.proxyUrl,callback:function(e){t.$set(t.form,"proxyUrl",e)},expression:"form.proxyUrl"}})],1),a("FormItem",{attrs:{label:"备注"}},[a("Input",{staticStyle:{width:"240px"},model:{value:t.form.remark,callback:function(e){t.$set(t.form,"remark",e)},expression:"form.remark"}})],1)],1),a("div",{attrs:{slot:"footer"},slot:"footer"},[a("Button",{staticStyle:{"margin-left":"8px"},attrs:{type:"text"},on:{click:function(e){t.value2=!1}}},[t._v("取消")]),a("Button",{attrs:{type:"primary"},on:{click:t.handleConfirm}},[t._v("确定")])],1)],1),a("Modal",{attrs:{title:"导入"},model:{value:t.value3,callback:function(e){t.value3=e},expression:"value3"}},[[a("Form",{attrs:{"label-width":100}},[a("FormItem",{attrs:{label:"提示："}},[t._v(" 请按照指定的模板上传数据，点击下载模板"),a("a",{on:{click:t.download}},[t._v("<<导入模板>>")])]),a("FormItem",{attrs:{label:"代码："}},[t._v(" 注意:域名正确格式为http://xxx.xxx 或 https://xxx.xxx ")]),a("FormItem",{attrs:{label:"上传文件："}},[a("input",{ref:"upload",attrs:{type:"file",name:"file",accept:".csv, application/vnd.openxmlformats-officedocument.spreadsheetml.sheet, application/vnd.ms-excel"},on:{change:t.filechange}})])],1)],a("div",{attrs:{slot:"footer"},slot:"footer"},[a("Button",{staticStyle:{"margin-left":"8px"},attrs:{type:"text"},on:{click:function(e){t.value3=!1}}},[t._v("取消")]),a("Button",{attrs:{type:"primary"},on:{click:t.upload}},[t._v("确定")])],1)],2)],1)}),[],!1,null,null,null);e.default=r.exports}}]);